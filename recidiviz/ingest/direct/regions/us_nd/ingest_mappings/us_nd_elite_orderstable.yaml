# yaml-language-server: $schema=./../../../ingest_mappings/yaml_schema/1.0.0/schema.json
manifest_language: 1.0.0
input_columns:
  - ORDER_ID
  - ORDER_STATUS
  - CONVICTION_DATE
  - COURT_DATE
  - COUNTY_CODE
  - ISSUING_AGY_LOC_ID
  - OFFENDER_BOOK_ID
  - JUDGE_NAME
  - COURT_INFO_ID
  - EFFECTIVE_DATE
  - SENTENCE_START_DATE
  - CREATE_DATETIME
  - MODIFY_DATETIME
unused_columns:
  - COURT_INFO_ID
  - EFFECTIVE_DATE
  - SENTENCE_START_DATE
  - CREATE_DATETIME
  - MODIFY_DATETIME
output:
  StatePerson:
    external_ids:
      - StatePersonExternalId:
          external_id:
            $custom:
              $function: us_nd_custom_parsers.decimal_str_as_int_str
              $args:
                dec_str: OFFENDER_BOOK_ID
          id_type: $literal("US_ND_ELITE_BOOKING")
    incarceration_sentences:
      - StateIncarcerationSentence:
          charges:
            - StateCharge:
                court_case:
                  StateCourtCase:
                    external_id:
                      $custom:
                        $function: us_nd_custom_parsers.decimal_str_as_int_str
                        $args:
                          dec_str: ORDER_ID
                    status:
                      $enum_mapping:
                        $raw_text: ORDER_STATUS
                        $mappings:
                          StateCourtCaseStatus.PRESENT_WITHOUT_INFO:
                            - "A"
                            - "ACC"
                            - "STEP"
                    date_convicted: CONVICTION_DATE
                    next_court_date: COURT_DATE
                    county_code:
                      $custom:
                        $function: us_nd_custom_parsers.normalize_county_code
                        $args:
                          county_code: COUNTY_CODE
                    judicial_district_code:
                      $custom:
                        $function: us_nd_custom_parsers.normalize_judicial_district_code
                        $args:
                          judicial_district_code_text: ISSUING_AGY_LOC_ID
                    judge:
                      StateAgent:
                        agent_type: $literal_enum(StateAgentType.JUDGE)
                        full_name:
                          $json_dict:
                            full_name: JUDGE_NAME
