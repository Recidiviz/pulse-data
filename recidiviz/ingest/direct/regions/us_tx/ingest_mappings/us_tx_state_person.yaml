# yaml-language-server: $schema=./../../../ingest_mappings/yaml_schema/1.0.0/schema.json
# This file associates the columns outputted from the query in `view_state_person` to the
# corresponding ingest Object fields.
manifest_language: 1.0.0
input_columns:
  FirstName: STRING
  MiddleName: STRING
  LastName: STRING
  Suffix: STRING
  OIMS_SID_NO: STRING
  Phone_Number: STRING
  TDCJ_NOs: STRING
  race: STRING
  sex: STRING
unused_columns: []
output:
  StatePerson:
    external_ids:
      - StatePersonExternalId:
          external_id: OIMS_SID_NO
          id_type: $literal("US_TX_SID")
      - $foreach:
          $iterable: TDCJ_NOs
          $result:
            StatePersonExternalId:
              external_id: $iter_item
              id_type: $literal("US_TX_TDCJ")
    full_name:
      $person_name:
        $given_names: FirstName
        $middle_names: MiddleName
        $surname: LastName
        $name_suffix: Suffix
    current_phone_number: Phone_Number
    sex:
      $enum_mapping:
        $raw_text: sex
        $mappings:
          StateSex.MALE:
            - "MALE"
          StateSex.FEMALE:
            - "FEMALE"
          StateSex.EXTERNAL_UNKNOWN: "UNKNOWN"
    races:
      - StatePersonRace:
          race:
            $enum_mapping:
              $raw_text: race
              $mappings:
                StateRace.ASIAN:
                  - "ASIAN OR PACIFIC ISLANDER"
                  - "ASIAN/PACIFIC ISLANDER"
                StateRace.BLACK: "BLACK"
                StateRace.AMERICAN_INDIAN_ALASKAN_NATIVE:
                  - "AMERICAN INDIAN OR ALASKAN"
                  - "AMERICAN INDIAN/ALASKAN"
                StateRace.EXTERNAL_UNKNOWN: "UNKNOWN"
                StateRace.WHITE:
                  - "WHITE"
                  - "HISPANIC"
                StateRace.OTHER: "OTHER"
    ethnicities:
      - StatePersonEthnicity:
          ethnicity:
            $enum_mapping:
              $raw_text: race
              $mappings:
                StateEthnicity.HISPANIC: "HISPANIC"
                StateEthnicity.NOT_HISPANIC:
                  - "ASIAN OR PACIFIC ISLANDER"
                  - "BLACK"
                  - "AMERICAN INDIAN OR ALASKAN"
                  - "WHITE"
                  - "ASIAN/PACIFIC ISLANDER"
                  - "OTHER"
                  - "AMERICAN INDIAN/ALASKAN"
                StateEthnicity.EXTERNAL_UNKNOWN: "UNKNOWN"
