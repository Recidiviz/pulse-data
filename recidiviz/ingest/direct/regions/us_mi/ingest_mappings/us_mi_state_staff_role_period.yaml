# yaml-language-server: $schema=./../../../ingest_mappings/yaml_schema/1.0.0/schema.json
manifest_language: 1.0.0
input_columns:
  - employee_id_omni
  - employee_id_compas
  - position_omni
  - period_seq_num
  - start_date
  - end_date
unused_columns: []
output:
  StateStaff:
    external_ids:
      - $conditional:
          - $if:
              $not_null: employee_id_omni
            $then:
              StateStaffExternalId:
                external_id: employee_id_omni
                id_type: $literal("US_MI_OMNI_USER")
      - $conditional:
          - $if:
              $not_null: employee_id_compas
            $then:
              StateStaffExternalId:
                external_id: employee_id_compas
                id_type: $literal("US_MI_COMPAS_USER")
    role_periods:
      - StateStaffRolePeriod:
          external_id:
            $concat:
              $values:
                - $conditional:
                    - $if:
                        $not_null: employee_id_omni
                      $then:
                        $concat:
                          $values:
                            - employee_id_omni
                            - $literal("OMNI")
                    - $else:
                        $concat:
                          $values:
                            - employee_id_compas
                            - $literal("COMPAS")
                - period_seq_num
          start_date: start_date
          end_date: end_date
          role_type:
            $conditional:
              - $if:
                  $is_null: position_omni
                $then: $literal_enum(StateStaffRoleType.INTERNAL_UNKNOWN)
              # TODO(#21718): Convert to $enum_mapping to actually map position_omni to different role types
              - $else: $literal_enum(StateStaffRoleType.INTERNAL_UNKNOWN)
