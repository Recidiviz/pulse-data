# yaml-language-server: $schema=./../../../ingest_mappings/yaml_schema/1.0.0/schema.json
# This file associates the columns outputted from the query in `view_incarceration_periods` to
#  corresponding Ingest Object fields.
manifest_language: 1.0.0
input_columns:
  period_id: INTEGER
  OFFENDERID: STRING
  start_datetime: STRING
  start_code: STRING
  start_reason: STRING
  end_datetime: STRING
  end_code: STRING
  end_reason: STRING
  JURISDICTIONALAGENCY: STRING
  OTHERLOCATIONCODE: STRING
  LOCATIONREPORTMOVEMENT: STRING
  p_facility_id: STRING
  p_facility_name: STRING
  p_facility_type: STRING
  p_unit_id: STRING
  p_unit_name: STRING
  p_unit_type: STRING
unused_columns:
  - JURISDICTIONALAGENCY
  - OTHERLOCATIONCODE
  - p_facility_name
  - p_unit_id
  - p_unit_type
  - LOCATIONREPORTMOVEMENT
  - end_reason
output:
  StatePerson:
    external_ids:
      - StatePersonExternalId:
          external_id: OFFENDERID
          id_type: $literal("US_CO_PID")
    incarceration_periods:
      - StateIncarcerationPeriod:
          external_id:
            $concat:
              $values:
                - OFFENDERID
                - period_id
          custodial_authority:
            $enum_mapping:
              $raw_text: p_facility_type #ORGANIZATIONTYPE from ORGANIZATIONPROF
              $mappings:
                StateCustodialAuthority.SUPERVISION_AUTHORITY:
                  - C9 # Parole Interstate Compact
                StateCustodialAuthority.STATE_PRISON:
                  - AI # Correctional Complex (of Facilities)
                  - A6 # Central Office Time & Release
                  - P3 # Dept. of (MH) Institutions
                  - B8 # County Jail Backlog
                  - Z4 # Fugitive Inmate (State Prison still counts them, so is still responsible authority)
                StateCustodialAuthority.OTHER_STATE:
                  - I4 # Other State Law Enforcement Agency
                # TODO(#50107): Properly assign these when validating this view
                StateCustodialAuthority.INTERNAL_UNKNOWN:
                  - A0 # Central Office Classifications
                  - A1 # DOC Executive Director's Office
                  - A2 # Central Office Accounting
                  - A3 # Central Office Offender Services
                  - A4 # Central Office Security
                  - A5 # Central Office Programs
                  - A7 # Central Office, OIT
                  - A8 # Central Office Research & Planning
                  - A9 # Training Academy
                  - AA # Human Resources
                  - AB # Construction Division
                  - AC # CDOC Collections
                  - AD # HR Training PC Lab
                  - AE # HR Training Off-Site
                  - AF # Offender File Location
                  - AG # Health Records Center
                  - AH # Central Office Health Services
                  - AJ # Inmate Appeals
                  - AK # K-9 Division
                  - AL # Victim Services Unit (VSU)
                  - AM # Stock Med Room
                  - AN # Central Office Court Services
                  - AO # Other Headquarters Offices
                  - AP # Community Referrals (and Movements) Unit (CRU)
                  - AQ # Telemed
                  - AS # Central Office SXO Registration Coordinator
                  - AT # Central Transportation
                  - AU # Central Office Internal Affairs
                  - AV # Vo-Tech
                  - AW # Centralized Trust Fund
                  - AX # Canteen
                  - AY # Warehouse/Pantry
                  - AZ # Contracted Canteen
                  - B0 # State Prison - Intake Only Facility
                  - B1 # State Prison - Major
                  - B2 # State Prison - Minimum
                  - B3 # Boot Camp
                  - B4 # Private Prison
                  - B6 # County Jail Contract
                  - B9 # Colorado Concurrent Sentences
                  - BC # City Jail Backlog
                  - BD # Interstate Corr. Compact (ICC)
                  - BE # CO Non-DOC Facility
                  - BF # Reception Center
                  - BG # Out-of-State Contract Facility
                  - BJ # Community Corrections Center
                  - BK # Intensive Supervision Program (ISP)
                  - BL # YOS Phase III Community Corrections
                  - BM # YOS Facility
                  - BN # Intensive Residential Treatment (IRT)
                  - BT # Other State Prison
                  - BW # State Mental Hospital
                  - BY # Parolees in Prison Facility
                  - C1 # Division of Adult Parole
                  - C2 # Parole Finance
                  - C3 # Parole Community Services
                  - C4 # Parole Planning & Placement
                  - C5 # Parole Inmate Services
                  - C6 # Parole Case Records Services
                  - C7 # Parole Fugitive Services
                  - C8 # Parole Administrative Services
                  - CA # Parole Offender Programs
                  - CB # Parole Hearing Unit
                  - CC # DCC MIS
                  - CD # Parole Training Unit
                  - D2 # Region Office
                  - D3 # Parole Office
                  - D4 # Satellite Office
                  - D5 # Community Corrections Center
                  - D6 # Day Reporting Center
                  - D7 # Drug Court
                  - D8 # DCC Warehouse/Kitchen
                  - D9 # DCC Canteen
                  - DA # Colorado Parole Apprehension Team
                  - DB # Parole Regional Unit
                  - E0 # Municipal Jail
                  - E1 # County Sheriff
                  - E2 # Colorado State Court
                  - E3 # Police Department
                  - E4 # City Name
                  - E5 # County Prosecuting Attorney
                  - E6 # County Health Department
                  - E7 # County Mental Health Dept
                  - E8 # Social Services
                  - E9 # Transitional Living
                  - EA # Colorado County or District Court
                  - EB # County District Attorney
                  - EC # Local Victim Witness Office
                  - ED # County Probation Office
                  - EL # Release Law Enforcement
                  - ES # State Police
                  - EU # University Police Department
                  - F1 # Parole Board
                  - F2 # Office of Juv. Offn. Review
                  - G1 # Hospital (Outside)
                  - G2 # Clinic (Outside)
                  - G3 # Doctor's Office (Outside)
                  - G4 # Other Medical (Outside)
                  - G5 # Mental Health Treatmt(Outside)
                  - G6 # Laboratory Provider
                  - G7 # TB Test Manufacturer
                  - G8 # Specialist (Outside)
                  - H1 # Community College
                  - H2 # University
                  - H3 # Trade School
                  - H4 # Adult Education / GED
                  - H5 # Other Education
                  - H6 # Public School (in Colorado)
                  - I1 # Other State ICC Office
                  - I2 # Other State Court
                  - I3 # Other State Parole Office
                  - I5 # Other State DOC
                  - I6 # DCC SOSRA Coordinator
                  - I7 # Other State Parole Board
                  - I8 # Other Country
                  - I9 # Other State District Attorney
                  - IA # Community Corrections Board (CCB)
                  - IB # Other State Probation Department
                  - J1 # DJJ Central Office
                  - J2 # Juris. Drug Task Force
                  - JA # Youth Correctional Facility
                  - JB # Foster Home
                  - JD # Group Home
                  - JE # Child Caring Institution (CCI)
                  - JF # Youth Reception Center
                  - JG # Youth Parole Office
                  - JH # Youth Conservation Camp
                  - K0 # Converted Agency
                  - K1 # Substance Abuse Treatment (Out-Patient)
                  - K2 # Domestic Violence Rehab
                  - K3 # Sex Offender Aftercare
                  - K4 # Parenting
                  - K5 # Life Skills
                  - K6 # Clothing / Food Assistance
                  - K7 # AA/NA
                  - K8 # Employment Agency
                  - K9 # Mental Health Counseling
                  - KA # Cognitive Therapy Provider
                  - KB # Client Choice Treatment Provider (CCTP)
                  - KC # CCTP/MAT Organization
                  - KD # Urinalysis Provider
                  - KI # Substance Abuse Treatment (In-Patient)
                  - KX # Other Referral Agency
                  - L1 # Medical Laboratory
                  - L2 # TB Test Manufacturer
                  - L3 # HIV Test Manufacturer
                  - L4 # Immunization Manufacturer
                  - M1 # Law Firm
                  - M2 # Electronic Monitoring
                  - M3 # Bank
                  - M4 # Extradition Company
                  - M5 # Hotel/Motel
                  - M6 # Restitution (Hot Checks)
                  - M7 # Insurance Company
                  - M8 # Other Non-Profit Agency
                  - M9 # Employer (Other)
                  - MA # Housing Vendor (Felon Friendly)
                  - MB # Retail Store
                  - MC # Vendor (Canteen & Other Inven)
                  - MD # Bank (for Colorado Inmate Banking Use only)
                  - ME # Obligation Payee
                  - MF # Food Services Employer
                  - MG # Smart Start Office
                  - MM # Media
                  - MP # SOSRA Polygraph Vendor
                  - MV # Volunteer
                  - MX # Housing Vendor (Felon Friendly)
                  - N1 # Religious Organization
                  - N2 # Service Clubs
                  - N3 # Child Care Center
                  - P0 # Colorado Crime Lab
                  - P1 # Governor's Office
                  - P2 # Dept of Human Services
                  - P4 # State Treasury
                  - P5 # Secretary of State
                  - P6 # Attorney General
                  - P7 # Dept. of Labor
                  - P8 # ACIC
                  - P9 # Other Government Agency
                  - PA # State Comptroller
                  - PB # Child Support Enforcement Agency
                  - PC # Registration Fee Trust - DOT DMV
                  - PD # DOC Bureau of Health Services (BHS)
                  - PE # CO Dept. of Motor Vehicles
                  - PF # State Fire Marshal
                  - PJ # State Department of Justice
                  - PL # State Legislature
                  - PP # PRCS Supervising Offices
                  - PS # Sex Offender Tracking Program (SOTP)
                  - PV # Victim Compensation & Government Claims Board
                  - R1 # Homeless Shelter
                  - R2 # Transient (i.e., Homeless)
                  - R3 # Sober Living
                  - R4 # Transitional Living
                  - T1 # Private Residence
                  - T2 # Temporary Lodging
                  - U1 # US Marshall
                  - U2 # US Probation
                  - U3 # Immigration & Nat. Service
                  - U4 # US Military
                  - U5 # Federal Bureau of Prisons (BOP)
                  - U6 # FBI Office
                  - U7 # DEA Office
                  - U8 # NCIC
                  - U9 # US District Court
                  - UA # Social Security Administration
                  - UB # Internal Revenue Service (IRS)
                  - UC # Veteran's Administration (VA)
                  - UD # Other Federal Detaining Agency
                  - UE # Federal Transfer Tracking
                  - X3 # Ext. Mvmt. Note 3 (Oth = UNK)
                  - X4 # Ext. Mvmt. Note 4 (Oth = prior Oth)
                  - X5 # Ext. Mvmt Note 5 (Oth = prior Rpt)
                  - Z1 # Not Specified
                  - Z2 # County (in Home State)
                  - Z3 # Victim Restitution (TBD)
                  - Z5 # Not Applicable
                  - Z9 # Unknown
                  - ZZ # Not Used
          admission_date: start_datetime
          release_date: end_datetime
          facility: p_facility_id
          housing_unit: p_unit_name
          housing_unit_type:
            $enum_mapping:
              $raw_text: p_unit_name
              $custom_parser: us_co_custom_enum_parsers.parse_housing_unit_type
          specialized_purpose_for_incarceration:
            $enum_mapping:
              $raw_text: start_reason #REASONFORMOVEMENT from EXTERNALMOVEMENT
              $mappings:
                StateSpecializedPurposeForIncarceration.GENERAL:
                  - "01" # Approved Transfer Request
                  - "02" # Closer To Home
                  - "04" # Spend Time in Quarantine
                  - "07" # Custody Change
                  - "08" # Discipline Problem
                  - "09" # Emergency
                  - "11" # Voluntarily Returned
                  - "12" # Placed in Jail Temporarily (CO call on general)
                  - "13" # Initial Classification
                  - "15" # Violation
                  - "16" # Close Status
                  - "17" # Program Placement
                  - "19" # GP Placement
                  - "20" # YOS Placement
                  - "21" # Work Assignment
                  - "22" # Progression
                  - "23" # Regressive
                  - "24" # Lateral
                  - "25" # Community Placement
                  - "26" # Off-site Appointment
                  - "31" # Court Appearance
                  - "32" # Completed
                  - "33" # Court Trial
                  - "35" # New Charge
                  - "36" # New Charge/Short Term
                  - "37" # Released In Error
                  - "39" # Arrested and Placed in Jail
                  - "49" # Released to Probation
                  - "50" # To Detainer/Warrant
                  - "51" # In State Supervision
                  - "52" # Out Of State Parole Supervision
                  - "53" # Parole Violator
                  - "55" # Technical Parole Violator
                  - "56" # Absconder in Custody In-State
                  - "58" # Jail Treatment (CO call for general because this code has to do with YOS failures, not really treatment)
                  - "5A" # Absconder in Custody Out of State
                  - "5B" # Received Enroute to Another Institutition
                  - "5C" # Escapee in Custody in State
                  - "5D" # Escapee in Custody Out of State
                  - "5M" # Enroute to Another Institution
                  - "60" # Accidental
                  - "70" # Completed Treatment
                  - "71" # Dental Needs
                  - "72" # Improved Health
                  - "73" # Medical Needs
                  - "74" # Mental Health Needs
                  - "75" # Bed Assignment (between Facilities in same Complex)
                  - "79" # Escape without Violence
                  - "81" # Escaped from CDOC
                  - "82" # PC Movement
                  - "85" # Temp. Move - Out-to-Court
                  - "86" # Temp. Move - Return from Court
                  - "87" # Temp. Move - Out to Infirmary
                  - "88" # Temp. Move - Return from Infirmary
                  - "89" # Temp. Move - Other
                  - "90" # Temp. Move - Return from Other
                  - "93" # Recaptured
                  - "99" # Not Specified
                  - "A1" # CO Discharge Return
                  - "A2" # CO Discharge Return with NC
                  - "A4" # Probation Violator
                  - "A5" # Returned from Bond
                  - "A6" # Court Order Return with NC
                  - "A7" # Probation Violator with NC
                  - "A8" # New Conviction
                  - "A9" # Possible Parole Violator (PPV)
                  - "AB" # YOS Offender
                  - "AC" # ICC - Inmate
                  - "AE" # Adult Offender Commitment
                  - "AF" # Court Order Return
                  - "AG" # Dual Commitment
                  - "AH" # Meets Criteria for Placement
                  - "AI" # Community Center Regression
                  - "AJ" # ISP-I Violator
                  - "AN" # Community Transition
                  - "AP" # YOS Failure/NC
                  - "AQ" # CO State Hospital Hold
                  - "AT" # Unauthorized Release
                  - "AW" # Regress from Comm. Center
                  - "AX" # Resume Supervision in CO Facility
                  - "BA" # Mandatory Parole
                  - "D4" # Interstate Compact
                  - "D6" # Regular or Medical
                  - "D7" # YOS Failure
                  - "D9" # Fire Crew Deployment
                  - "DA" # Heavy Equipment Crew Deployment
                  - "DB" # Parolee Serving Time in another State D
                  - "DC" # Out-of-State Detainer
                  - "DE" # U.S. Immigration and Naturalization
                  - "DF" # In Custody - Other than Revocation Process
                  - "DK" # Parole to Charges
                  - "DN" # Community Supervision Offender
                  - "JB" # Jail Backlog
                  - "P1" # Awaiting Transfer from Parole to Jail
                  - "P2" # Parolee at non-CDOC Facility (see movement comments)
                  - "P3" # Parole Revocation to Comm. Return to Custody
                  - "P6" # Parole Revocation to Comm. Return to Custody Regress
                  - "P7" # See External Movement Comments
                  - "P8" # Community  Regressive - Awaiting Transfer to Facility
                  - "P9" # Special Custody
                  - "PA" # Technical Parolee Awaiting Transfer to Facility
                  - "PB" # Parole Revocation Back to Jail
                  - "PC" # Parole Revocation to Community Center
                  - "PD" # Awaiting Transportation to a Facility
                  - "PF" # Jail Backlog Awaiting Discharge
                  - "PG" # ISP - Inmate
                  - "PK" # Community Jail Transfer
                  - "T1" # DAY TRIP / STERLING REGIONAL MEDICAL CENTER
                  - "T2" # DAY TRIP TO BUENA VISTA MINIMUM CENTER
                  - "T3" # DAY TRIP BVCF MEDICAL
                  - "T4" # DAY TRIP TRINIDAD
                  - "T5" # DAY TRIP - BRUSH MEDICAL
                  - "T6" # DAY TRIP CASTLEROCK
                  - "T7" # DAY TRIP ROCKY MOUNTAIN ORTHO/FT. COLLINS
                  - "TA" # DAY TRIP AURORA
                  - "TB" # DAY TRIP CANON CITY
                  - "TC" # DAY TRIP CEDARIDGEs
                  - "TD" # DAY TRIP COLORADO SPRINGS
                  - "TE" # DAY TRIP DELTA
                  - "TF" # DAY TRIP DENVER
                  - "TG" # DAY TRIP GLENWOOD SPRINGS
                  - "TH" # DAY TRIP HUGO
                  - "TI" # DAY TRIP LA JUNTA
                  - "TJ" # DAY TRIP LAKEWOOD
                  - "TK" # DAY TRIP LEADVILLE
                  - "TL" # DAY TRIP LIMON
                  - "TM" # DAY TRIP MONTROSE
                  - "TN" # DAY TRIP PUEBLO
                  - "TO" # DAY TRIP RIFLE
                  - "TP" # DAY TRIP SALIDA
                  - "TQ" # DAY TRIP RANGELY
                  - "TR" # DAY TRIP TO BUENA VISTA
                  - "TS" # DAY TRIP TO AVCF
                  - "TT" # DAY TRIP TO ARKANSAS VALLEY REGIONAL MEDICAL CENTR
                  - "TU" # DAY TRIP TO SANCARLOS
                  - "TV" # DAY TRIP TO FREMONT CORRECTIONAL FACILITY
                  - "TW" # DAY TRIP TO CTCF INFIRMARY
                  - "TX" # DAY TRIP TO DRDC INFIRMARY
                  - "TY" # DAY TRIP TO COLORADO MENTAL HEALTH INST IN PUEBLO
                  - "TZ" # DAY TRIP/LAS ANIMAS
                  - "V1" # From Jail
                  - "V2" # From Hospital
                  - "V3" # From ICC
                  - "V4" # From Other Jurisdiction
                  - "V5" # From ISP-I
                # TODO(#50107): Properly assign these when validating this view
                StateSpecializedPurposeForIncarceration.INTERNAL_UNKNOWN:
                  - "03" # To ICE Custody
                  - "06" # Criteria Not Met
                  - "0A" # County Contract Boarder
                  - "14" # Returned to Sending State
                  - "18" # Variance
                  - "27" # Intensive Residential Treatment
                  - "28" # Posted Bond
                  - "29" # Own Recognizance
                  - "30" # Private Custody during Hospital Stay
                  - "34" # Governor's Order
                  - "38" # Court Appearance (with DRAG Order)
                  - "40" # Sentence Modified
                  - "41" # Sentenced to Oth. Jurisdiction
                  - "42" # Sentence Revoked/Remanded
                  - "43" # Sentence Vacated
                  - "44" # Witness
                  - "45" # Released by Court
                  - "48" # Early Parole Discharge
                  - "54" # In-State Parole Reinstated
                  - "57" # Sure and Swift
                  - "59" # Finished serving Sentence
                  - "5E" # Establish Residence
                  - "5J" # Compassionate Release Orderd by the Court
                  - "5K" # Inmate Walked Away
                  - "61" # Justified Homicide
                  - "62" # Murdered
                  - "63" # Natural Causes
                  - "64" # Suicide
                  - "65" # Lethal Injection
                  - "66" # Execution
                  - "67" # Death - Other
                  - "76" # Terminal Illness
                  - "78" # Escape with Violence
                  - "80" # Attempted Escape
                  - "83" # Start Intensive Treatment Program
                  - "84" # End Intensive Treatment Program
                  - "92" # Overcrowding
                  - "94" # Facility to ISP-I.
                  - "9A" # Privilege
                  - "9B" # 24-hour
                  - "9C" # 48-hour
                  - "9D" # Funeral
                  - "9E" # Family Emergency
                  - "9F" # Medical
                  - "A0" # See Disposition
                  - "A3" # YOS Resentence
                  - "AA" # Discharge to Probation Failed
                  - "AD" # Court Ordered Release Failed
                  - "AK" # ICC - Parolee
                  - "AL" # ICC - Probationer
                  - "AM" # Dual ICC
                  - "AR" # To Probation
                  - "AS" # Probation with NC
                  - "AU" # Regress on Summons
                  - "AV" # Revoked on Summons
                  - "AY" # Approved for Community Corrections
                  - "AZ" # See Case Notes
                  - "B1" # Discretionary Parole
                  - "B2" # Discretionary - Weekend
                  - "B3" # Discretionary - Accelerated Transition
                  - "B4" # Discretionary - SB 241
                  - "B5" # Discretionary (2001-2004)
                  - "B6" # Discretionary - SB 03-252
                  - "BB" # Mandatory Parole - Weekend
                  - "BC" # Mandatory Parole - HB1351 ERT
                  - "BD" # Mandatory Parole (2001-2004)
                  - "BE" # Mandatory Reparole
                  - "BF" # Mandatory Reparole - Weekend
                  - "BG" # Special Needs Parole
                  - "BH" # INS Detainer (ICE)
                  - "BJ" # INS Deportation (ICE)
                  - "C1" # Mandatory Release - per Martin Cooper
                  - "C2" # Sentence Discharge - 1087
                  - "C3" # Appeal Bond
                  - "C4" # CSH Transfer - Executive Order
                  - "C5" # Federal Bureau Of Prisons
                  - "C6" # Inactivated
                  - "C7" # Dual In-State Compact (usually CSP)
                  - "C8" # Dual CO Sentence & Interstate Compact
                  - "CX" # CCC - Return to Parole
                  - "D1" # Other Jails
                  - "D2" # Federal Detainer
                  - "D3" # Absconder - Mandatory Discharge
                  - "D5" # Interstate Violation Case Closed
                  - "D8" # International Discharge
                  - "DD" # U.S. Marshall Custody
                  - "DG" # Colorado Detainer
                  - "DH" # Discharge to Charges
                  - "DI" # To another State
                  - "DJ" # Intensive Supervision Escape
                  - "DL" # Other State Detainer
                  - "DM" # Low Risk/Low Custody Absconder
                  - "DP" # United States Marshal
                  - "DX" # DWCF - Return to Parole
                  - "DY" # YOS - Phase III
                  - "DZ" # Parolee Transfer to CCC
                  - "F1" # ICC Sentence Served-Pickup CO Sentence
                  - "P4" # Parole Office changed
                  - "PE" # Returned to Parole from Abscond
                  - "PH" # Parolee in Prison
                  - "PJ" # ISP - Parolee
                  - "T8" # DAY TRIP DEAN MCGEE EYE INSTITUTE, OK
                  - "X1" # External Movement Note 1
                  - "X8" # Possible Parole Violator (PPV)
          admission_reason:
            $enum_mapping:
              $raw_text: start_code
              $mappings:
                StateIncarcerationPeriodAdmissionReason.INTERNAL_UNKNOWN:
                  - "79" # Returned to ISP-I
                  # TODO(#50107): Properly assign these when validating this view
                  - "11" # Returned as Parolee in Prison
                  - "14" # Returned from Dual Commitment
                  - "15" # Terminated from YOS Ph. III
                  - "28" # Returned from Abscond
                  - "34" # Assigned To Central Office
                  - "35" # Received from ISP Facility
                  - "38" # Arrested Parolee
                  - "3B" # Returned to ISP-I Location
                  - "40" # Discharged
                  - "50" # Commutation
                  - "52" # Released By Court
                  - "54" # Full Pardon
                  - "55" # Released after Erroneous Admission
                  - "60" # Paroled
                  - "63" # To Intensive Supervision Program (ISP-I)
                  - "65" # To YOS Phase III
                  - "73" # Out to Dual Commitment
                  - "74" # Transfered Interstate
                  - "75" # Death
                  - "77" # Execution
                  - "78" # Returned to Parole
                  - "85" # Transferred Out-Of-State (ICC)
                  - "88" # Absconded from Parole
                  - "8D" # Out to Other Jurisdiction
                  - "95" # Transferred to ISP Facility
                StateIncarcerationPeriodAdmissionReason.TEMPORARY_RELEASE:
                  - "81" # Out to Court
                  - "82" # Out on Escorted Leave
                  - "83" # Out to Hospital
                  - "84" # Out on Bond
                  - "86" # Out on Furlough
                  - "8B" # Out on Work Crew
                StateIncarcerationPeriodAdmissionReason.ESCAPE:
                  - "33" # Escapee in Custody - Other Jurisdiction (seen as Escapee in CO)
                  - "8C" # Absent without Leave (AWOL)
                  - "8E" # AWOL from ISP-I
                  - "80" # Escaped
                  - "56" # Unauthorized Release - TODO(#13602) Update after schema change includes erroneous release
                StateIncarcerationPeriodAdmissionReason.NEW_ADMISSION:
                  - "01" # New CO Commitment
                  - "03" # YOS Commitment
                  - "06" # Recommitment
                StateIncarcerationPeriodAdmissionReason.RETURN_FROM_ESCAPE:
                  - "20" # Return from Escape
                  - "2C" # Returned from AWOL
                StateIncarcerationPeriodAdmissionReason.RETURN_FROM_TEMPORARY_RELEASE:
                  - "21" # Returned from Court
                  - "22" # Returned from Escorted Leave
                  - "23" # Returned from Hospital
                  - "24" # Returned from Bond
                  - "25" # Returned from ICC
                  - "26" # Returned from Furlough
                  - "2B" # Returned from Work Crew
                  - "39" # Day Trip (to)
                StateIncarcerationPeriodAdmissionReason.REVOCATION:
                  - "10" # Returned from Parole
                StateIncarcerationPeriodAdmissionReason.STATUS_CHANGE:
                  - "13" # Terminated from ISP-I
                  - "32" # Received at County/City Jail  (Often for regression or YOS failure or new charge)
                  - "36" # Offender situation changed
                  - "37" # Halfway-In (at CCC)
                  - "63-I" # To Intensive Supervision Program (ISP) - INMATE
                StateIncarcerationPeriodAdmissionReason.TRANSFER:
                  - "3A" # Reassigned to another Facility
                  - "30" # Received at DOC Facility
                  - "31" # Received at Community Center
                  - "90" # Transferred to DOC Facility (added bc saw in start codes)
                  - "91" # Transferred to Community Center
                  - "92" # Transferred to County/City Jail
                StateIncarcerationPeriodAdmissionReason.TRANSFER_FROM_OTHER_JURISDICTION:
                  - "2D" # Returned from Other Jurisdiction
                  - "07" # ICC Commitment
          release_reason:
            $enum_mapping:
              $raw_text: end_code
              $mappings:
                StateIncarcerationPeriodReleaseReason.RELEASED_TO_SUPERVISION:
                  - "78" # Returned to Parole
                StateIncarcerationPeriodReleaseReason.RELEASED_FROM_ERRONEOUS_ADMISSION:
                  - "55" # Released after Erroneous Admission
                StateIncarcerationPeriodReleaseReason.COMMUTED:
                  - "50" # Commutation
                StateIncarcerationPeriodReleaseReason.TRANSFER:
                  - "30" # Received at DOC Facility
                  - "31" # Received at Community Center
                  - "32" # Received at County/City Jail
                  - "3A" # Reassigned to another Facility
                  - "79" # Returned to ISP-I
                  - "90" # Transferred to DOC Facility
                  - "91" # Transferred to Community Center
                  - "92" # Transferred to County/City Jail
                StateIncarcerationPeriodReleaseReason.ESCAPE:
                  - "33" # Escapee In Custody - Other Jurisdiction
                  - "80" # Escaped
                  - "88" # Absconded from Parole
                  - "8C" # Absent without Leave (AWOL)
                  - "8E" # AWOL from ISP-I
                StateIncarcerationPeriodReleaseReason.TEMPORARY_RELEASE:
                  - "39" # Day Trip (to)
                  - "81" # Out To Court
                  - "82" # Out on Escorted Leave
                  - "83" # Out to Hospital
                  - "84" # Out on Bond
                  - "86" # Out on Furlough
                  - "8B" # Out on Work Crew
                StateIncarcerationPeriodReleaseReason.TRANSFER_TO_OTHER_JURISDICTION:
                  - "74" # Transferred Interstate
                  - "85" # Transferred Out-of-State (ICC)
                  - "8D" # Out to Other Jurisdiction
                StateIncarcerationPeriodReleaseReason.SENTENCE_SERVED:
                  - "40" # Discharged
                StateIncarcerationPeriodReleaseReason.RETURN_FROM_TEMPORARY_RELEASE:
                  - "21" # Returned from Court
                  - "22" # Returned from Escorted Leave
                  - "23" # Returned from Hospital
                  - "24" # Return from Bond
                  - "26" # Returned from Furlough
                  - "2B" # Returned from Work Crew
                StateIncarcerationPeriodReleaseReason.RETURN_FROM_ESCAPE:
                  - "20" # Return from Escape
                  - "2C" # Returned from AWOL
                StateIncarcerationPeriodReleaseReason.INTERNAL_UNKNOWN:
                  - "01" # New CO Commitment
                  - "06" # Recommitment
                  - "10" # Returned from Parole
                  - "2D" # Returned from Other Jurisdiction
                  - "37" # Halfway-In (at CCC)
                  # TODO(#50107): Properly assign these when validating this view
                  - "03" # YOS Commitment
                  - "07" # ICC Commitment
                  - "11" # Returned as Parolee in Prison
                  - "14" # Returned from Dual Commitment
                  - "15" # Terminated from YOS Ph. III
                  - "25" # Returned from ICC
                  - "28" # Returned from Abscond
                  - "34" # Assigned To Central Office
                  - "35" # Received from ISP Facility
                  - "38" # Arrested Parolee
                  - "3B" # Returned to ISP-I Location
                  - "54" # Full Pardon
                  - "63" # To Intensive Supervision Program (ISP-I)
                  - "65" # To YOS Phase III
                  - "73" # Out to Dual Commitment
                  - "77" # Execution
                  - "95" # Transferred to ISP Facility
                StateIncarcerationPeriodReleaseReason.CONDITIONAL_RELEASE:
                  - "60" # Paroled
                  - "63-P" # To Intensive Supervision (ISP) - Parole
                StateIncarcerationPeriodReleaseReason.COURT_ORDER:
                  - "52" # Released by Court
                StateIncarcerationPeriodReleaseReason.DEATH:
                  - "75" # Death
                StateIncarcerationPeriodReleaseReason.RELEASED_IN_ERROR:
                  - "56" # Unauthorized Release
                StateIncarcerationPeriodReleaseReason.STATUS_CHANGE:
                  - "13" # Terminated from ISP-I
                  - "36" # Offender Situation Changed
                  - "63-I" # To Intensive Supervision Program (ISP) - INMATE
