# Configuration for which validations to run for region US_ND.

region_code: US_ND
exclusions:
  - validation_name: overlapping_supervision_periods
    exclusion_type: DOES_NOT_APPLY
    exclusion_reason:
      ND ingest constructs one supervision period per supervision sentence - we expect supervision
      periods to overlap
max_allowed_error_overrides:
  - validation_name: incarceration_population_by_facility_external_comparison
    hard_max_allowed_error_override: 0.05
    override_reason:
      Given the very small size of some facilities in ND, this is actually a very strict threshold and we
      likely will not be able to do better. We're also already checking facility accuracy over the whole population with
      incarceration_population_person_level_external_comparison_matching_people validation.
  - validation_name: client_record_archive_duplicate_person_ids
    hard_max_allowed_error_override: 0.001
    override_reason:
      TODO(#15057) - Known issue where additional deduping is required. It affects
      literally one person so even this threshold is pretty generous
  - validation_name: client_record_duplicate_person_external_ids
    hard_max_allowed_error_override: 0.001
    override_reason:
      TODO(#15057) - Known issue where additional deduping is required. It affects
      literally one person so even this threshold is pretty generous
  - validation_name: most_recent_face_to_face_contact_date_by_person_by_state_comparison
    hard_max_allowed_error_override: 0.20
    override_reason: |
      TODO(#16865): Our supervision case compliance logic only includes contacts since
      the start of supervision, so if someone has not had a face to face contact since
      they started this most recent stint of supervision then `etl_clients` will have a
      `NULL` date. The other side of this comparison just pulls the most recent face to
      face contact from `normalized_state`, so if they have had one on a prior stint of
      supervision this will fail. We are going to delete this validation in the future
      so ignoring this failure for now.
num_allowed_rows_overrides:
  - validation_name: overlapping_incarceration_periods
    hard_num_allowed_rows_override: 550
    override_reason:
      TODO(#5803), TODO(#10577), TODO(#10682) - Needs investigation.
      Likely related to shifting IP external ids / not handling object deletion properly.
  - validation_name: incarceration_admission_after_open_period
    hard_num_allowed_rows_override: 250
    override_reason: TODO(#5803), TODO(#10577), TODO(#10682) - Needs investigation.
  - validation_name: invalid_admission_reason_and_pfi
    hard_num_allowed_rows_override: 10
    override_reason:
      TODO(#3723) - As of 12/07/2021 there are 4 REVOCATION admission to
      OOS (out of state) which maps to INTERNAL_UNKNOWN PFI. This should be fixed when
      we have a comprehensive fix for handling OOS in ND.
  - validation_name: incarceration_release_prior_to_admission
    hard_num_allowed_rows_override: 20
    override_reason:
      TODO(#5803), TODO(#10577), TODO(#10682) - Needs investigation.
      Likely related to shifting IP external ids / not handling object deletion properly.
  - validation_name: incarceration_admission_nulls
    hard_num_allowed_rows_override: 1500
    override_reason: TODO(#5803), TODO(#10682) - Needs investigation.
  - validation_name: supervision_termination_reason_no_date
    hard_num_allowed_rows_override: 1
    override_reason: TODO(#5803), TODO(#10682) - Needs investigation.
  - validation_name: supervision_termination_prior_to_start
    hard_num_allowed_rows_override: 300
    override_reason: TODO(#5803), TODO(#10682) - Needs investigation.
  - validation_name: admission_pfi_pop_pfi_mismatch
    hard_num_allowed_rows_override: 20
    override_reason: TODO(#10625) - Need to be handled in IP pre-processing.
  - validation_name: sentence_end_dates_before_start_dates
    hard_num_allowed_rows_override: 4000
    override_reason: Needs investigation.  Current failing level as of 10/21 is 2,834 rows #TODO(#16188)
  - validation_name: session_new_admissions_with_no_sentence_date_imposed
    hard_num_allowed_rows_override: 11000
    override_reason: Needs investigation.  Current failing level as of 10/26 is 8,823 rows #TODO(#16231)
  - validation_name: session_liberty_releases_with_no_sentence_completion_date
    hard_num_allowed_rows_override: 1100
    override_reason: Needs investigation.  Current failing level as of 10/26 is 903 rows #TODO(#16241)
  - validation_name: sentences_missing_date_imposed
    hard_num_allowed_rows_override: 30000
    override_reason: Needs investigation.  Current failing level as of 11/2 is 20,160 rows #TODO(#16436)
