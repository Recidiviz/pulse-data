# Configuration for which validations to run for region US_PA.

region_code: US_PA
exclusions:
  - validation_name: supervision_population_person_level_external_comparison_matching_people_supervision_level
    exclusion_type: DOES_NOT_APPLY
    exclusion_reason: PA has not provided us with person-level validation data for supervision level
  - validation_name: supervision_population_person_level_external_comparison_matching_people_supervising_officer
    exclusion_type: DOES_NOT_APPLY
    exclusion_reason: PA has not provided us with person-level validation data for supervising officers
  - validation_name: active_in_population_after_death_date
    exclusion_type: DOES_NOT_APPLY
    exclusion_reason: TODO(#6928) The pre-processing for periods ending in death is incomplete.
max_allowed_error_overrides:
  - validation_name: supervision_population_person_level_external_comparison
    max_allowed_error_override: 0.03
    override_reason: PA external validation data was generated from snapshots at the time the population for a given
      month was measured. Over time, data gets backfilled as new info about what happened that month comes in, so our
      numbers will get "worse" as time goes on and we get more accurate data about movements.
  - validation_name: supervision_population_person_level_external_comparison_matching_people_district
    max_allowed_error_override: 0.01
    override_reason: Here we make the threshold stricter than the default of 0.02.
  - validation_name: supervision_termination_person_level_external_comparison
    max_allowed_error_override: 0.03
    override_reason: We have a slightly higher error rate (~3%) than we
      usually allow for our person-level supervision terminations comparison. This is
      due to a methodology discrepancy between ourselves and US_PA regarding counting a
      termination if a person continues to be on supervision after the "termination"
      date. There are some instances where US_PA counts a person as having a supervision
      termination on a date where the person actually continues on supervision (for
      another type of supervision). We are not counting these as terminations, causing
      the ~3% error rate.
num_allowed_rows_overrides:
  - validation_name: incarceration_admission_after_open_period
    num_allowed_rows_override: 50
    override_reason: There is a small amount of disagreement between the two data
      sources we pull data from to hydrate incarceration periods - CCIS tables and DOC
      tables. This value was 12 as of 3/5/2021 and we expect that it may slowly grow
      over time as new data is added.
  - validation_name: overlapping_incarceration_periods
    num_allowed_rows_override: 200
    override_reason: There is a small amount of disagreement between the two data
      sources we pull data from to hydrate incarceration periods - CCIS tables and DOC
      tables. This value was 133 as of 3/5/2021 and we expect that it may slowly grow
      over time as new data is added.
  - validation_name: overlapping_supervision_periods
    num_allowed_rows_override: 150
    override_reason: TODO(#6253) - Likely a rare edge case related to ordering movements
      in the PA supervision_period ingest view. There are 95 of these as of 3/5/2021.
  - validation_name: supervision_termination_prior_to_start
    num_allowed_rows_override: 50
    override_reason: TODO(#6254) - Likely a rare edge case related to how the ingest
      view and entity matching handles cases where a supervision period is deleted.
      There are 12 of these as of 3/5/2021.
