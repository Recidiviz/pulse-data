# Recidiviz - a data platform for criminal justice reform
# Copyright (C) 2020 Recidiviz, Inc.
#
# This program is free software: you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program.  If not, see <https://www.gnu.org/licenses/>.
# =============================================================================
"""Tests the recidiviz/source_tables/update_big_query_table_schemas.py file that issues updates to BigQuery schemas"""

import pytest

from recidiviz.big_query.big_query_client import BigQueryClient
from recidiviz.source_tables.collect_all_source_table_configs import (
    build_source_table_repository_for_collected_schemata,
)
from recidiviz.source_tables.dataflow_output_table_collector import (
    get_dataflow_output_source_table_collections,
)
from recidiviz.source_tables.source_table_config import SourceTableCollection
from recidiviz.source_tables.source_table_repository import SourceTableRepository
from recidiviz.source_tables.source_table_update_manager import SourceTableUpdateManager
from recidiviz.source_tables.update_big_query_table_schemas import (
    collect_managed_source_table_collections,
    update_all_source_table_schemas,
)
from recidiviz.tests.big_query.big_query_emulator_test_case import (
    BigQueryEmulatorTestCase,
)

EXPECTED_DATAFLOW_OUTPUT_TABLES = [
    "dataflow_metrics.incarceration_admission_metrics",
    "dataflow_metrics.incarceration_commitment_from_supervision_metrics",
    "dataflow_metrics.incarceration_population_span_metrics",
    "dataflow_metrics.incarceration_release_metrics",
    "dataflow_metrics.program_participation_metrics",
    "dataflow_metrics.recidivism_rate_metrics",
    "dataflow_metrics.supervision_case_compliance_metrics",
    "dataflow_metrics.supervision_out_of_state_population_metrics",
    "dataflow_metrics.supervision_population_metrics",
    "dataflow_metrics.supervision_population_span_metrics",
    "dataflow_metrics.supervision_start_metrics",
    "dataflow_metrics.supervision_success_metrics",
    "dataflow_metrics.supervision_termination_metrics",
    "dataflow_metrics.violation_with_response_metrics",
    "supplemental_data.us_ix_case_note_matched_entities",
    "us_ar_normalized_state.state_assessment",
    "us_ar_normalized_state.state_charge",
    "us_ar_normalized_state.state_charge_incarceration_sentence_association",
    "us_ar_normalized_state.state_charge_supervision_sentence_association",
    "us_ar_normalized_state.state_charge_v2",
    "us_ar_normalized_state.state_charge_v2_state_sentence_association",
    "us_ar_normalized_state.state_drug_screen",
    "us_ar_normalized_state.state_early_discharge",
    "us_ar_normalized_state.state_employment_period",
    "us_ar_normalized_state.state_incarceration_incident",
    "us_ar_normalized_state.state_incarceration_incident_outcome",
    "us_ar_normalized_state.state_incarceration_period",
    "us_ar_normalized_state.state_incarceration_sentence",
    "us_ar_normalized_state.state_person",
    "us_ar_normalized_state.state_person_address_period",
    "us_ar_normalized_state.state_person_alias",
    "us_ar_normalized_state.state_person_ethnicity",
    "us_ar_normalized_state.state_person_external_id",
    "us_ar_normalized_state.state_person_housing_status_period",
    "us_ar_normalized_state.state_person_race",
    "us_ar_normalized_state.state_program_assignment",
    "us_ar_normalized_state.state_sentence",
    "us_ar_normalized_state.state_sentence_group",
    "us_ar_normalized_state.state_sentence_group_length",
    "us_ar_normalized_state.state_sentence_inferred_group",
    "us_ar_normalized_state.state_sentence_length",
    "us_ar_normalized_state.state_sentence_status_snapshot",
    "us_ar_normalized_state.state_staff",
    "us_ar_normalized_state.state_staff_caseload_type_period",
    "us_ar_normalized_state.state_staff_external_id",
    "us_ar_normalized_state.state_staff_location_period",
    "us_ar_normalized_state.state_staff_role_period",
    "us_ar_normalized_state.state_staff_supervisor_period",
    "us_ar_normalized_state.state_supervision_case_type_entry",
    "us_ar_normalized_state.state_supervision_contact",
    "us_ar_normalized_state.state_supervision_period",
    "us_ar_normalized_state.state_supervision_sentence",
    "us_ar_normalized_state.state_supervision_violated_condition_entry",
    "us_ar_normalized_state.state_supervision_violation",
    "us_ar_normalized_state.state_supervision_violation_response",
    "us_ar_normalized_state.state_supervision_violation_response_decision_entry",
    "us_ar_normalized_state.state_supervision_violation_type_entry",
    "us_ar_normalized_state.state_task_deadline",
    "us_ar_state.state_assessment",
    "us_ar_state.state_charge",
    "us_ar_state.state_charge_incarceration_sentence_association",
    "us_ar_state.state_charge_supervision_sentence_association",
    "us_ar_state.state_charge_v2",
    "us_ar_state.state_charge_v2_state_sentence_association",
    "us_ar_state.state_drug_screen",
    "us_ar_state.state_early_discharge",
    "us_ar_state.state_employment_period",
    "us_ar_state.state_incarceration_incident",
    "us_ar_state.state_incarceration_incident_outcome",
    "us_ar_state.state_incarceration_period",
    "us_ar_state.state_incarceration_sentence",
    "us_ar_state.state_person",
    "us_ar_state.state_person_address_period",
    "us_ar_state.state_person_alias",
    "us_ar_state.state_person_ethnicity",
    "us_ar_state.state_person_external_id",
    "us_ar_state.state_person_housing_status_period",
    "us_ar_state.state_person_race",
    "us_ar_state.state_program_assignment",
    "us_ar_state.state_sentence",
    "us_ar_state.state_sentence_group",
    "us_ar_state.state_sentence_group_length",
    "us_ar_state.state_sentence_length",
    "us_ar_state.state_sentence_status_snapshot",
    "us_ar_state.state_staff",
    "us_ar_state.state_staff_caseload_type_period",
    "us_ar_state.state_staff_external_id",
    "us_ar_state.state_staff_location_period",
    "us_ar_state.state_staff_role_period",
    "us_ar_state.state_staff_supervisor_period",
    "us_ar_state.state_supervision_case_type_entry",
    "us_ar_state.state_supervision_contact",
    "us_ar_state.state_supervision_period",
    "us_ar_state.state_supervision_sentence",
    "us_ar_state.state_supervision_violated_condition_entry",
    "us_ar_state.state_supervision_violation",
    "us_ar_state.state_supervision_violation_response",
    "us_ar_state.state_supervision_violation_response_decision_entry",
    "us_ar_state.state_supervision_violation_type_entry",
    "us_ar_state.state_task_deadline",
    "us_az_normalized_state.state_assessment",
    "us_az_normalized_state.state_charge",
    "us_az_normalized_state.state_charge_incarceration_sentence_association",
    "us_az_normalized_state.state_charge_supervision_sentence_association",
    "us_az_normalized_state.state_charge_v2",
    "us_az_normalized_state.state_charge_v2_state_sentence_association",
    "us_az_normalized_state.state_drug_screen",
    "us_az_normalized_state.state_early_discharge",
    "us_az_normalized_state.state_employment_period",
    "us_az_normalized_state.state_incarceration_incident",
    "us_az_normalized_state.state_incarceration_incident_outcome",
    "us_az_normalized_state.state_incarceration_period",
    "us_az_normalized_state.state_incarceration_sentence",
    "us_az_normalized_state.state_person",
    "us_az_normalized_state.state_person_address_period",
    "us_az_normalized_state.state_person_alias",
    "us_az_normalized_state.state_person_ethnicity",
    "us_az_normalized_state.state_person_external_id",
    "us_az_normalized_state.state_person_housing_status_period",
    "us_az_normalized_state.state_person_race",
    "us_az_normalized_state.state_program_assignment",
    "us_az_normalized_state.state_sentence",
    "us_az_normalized_state.state_sentence_group",
    "us_az_normalized_state.state_sentence_group_length",
    "us_az_normalized_state.state_sentence_inferred_group",
    "us_az_normalized_state.state_sentence_length",
    "us_az_normalized_state.state_sentence_status_snapshot",
    "us_az_normalized_state.state_staff",
    "us_az_normalized_state.state_staff_caseload_type_period",
    "us_az_normalized_state.state_staff_external_id",
    "us_az_normalized_state.state_staff_location_period",
    "us_az_normalized_state.state_staff_role_period",
    "us_az_normalized_state.state_staff_supervisor_period",
    "us_az_normalized_state.state_supervision_case_type_entry",
    "us_az_normalized_state.state_supervision_contact",
    "us_az_normalized_state.state_supervision_period",
    "us_az_normalized_state.state_supervision_sentence",
    "us_az_normalized_state.state_supervision_violated_condition_entry",
    "us_az_normalized_state.state_supervision_violation",
    "us_az_normalized_state.state_supervision_violation_response",
    "us_az_normalized_state.state_supervision_violation_response_decision_entry",
    "us_az_normalized_state.state_supervision_violation_type_entry",
    "us_az_normalized_state.state_task_deadline",
    "us_az_state.state_assessment",
    "us_az_state.state_charge",
    "us_az_state.state_charge_incarceration_sentence_association",
    "us_az_state.state_charge_supervision_sentence_association",
    "us_az_state.state_charge_v2",
    "us_az_state.state_charge_v2_state_sentence_association",
    "us_az_state.state_drug_screen",
    "us_az_state.state_early_discharge",
    "us_az_state.state_employment_period",
    "us_az_state.state_incarceration_incident",
    "us_az_state.state_incarceration_incident_outcome",
    "us_az_state.state_incarceration_period",
    "us_az_state.state_incarceration_sentence",
    "us_az_state.state_person",
    "us_az_state.state_person_address_period",
    "us_az_state.state_person_alias",
    "us_az_state.state_person_ethnicity",
    "us_az_state.state_person_external_id",
    "us_az_state.state_person_housing_status_period",
    "us_az_state.state_person_race",
    "us_az_state.state_program_assignment",
    "us_az_state.state_sentence",
    "us_az_state.state_sentence_group",
    "us_az_state.state_sentence_group_length",
    "us_az_state.state_sentence_length",
    "us_az_state.state_sentence_status_snapshot",
    "us_az_state.state_staff",
    "us_az_state.state_staff_caseload_type_period",
    "us_az_state.state_staff_external_id",
    "us_az_state.state_staff_location_period",
    "us_az_state.state_staff_role_period",
    "us_az_state.state_staff_supervisor_period",
    "us_az_state.state_supervision_case_type_entry",
    "us_az_state.state_supervision_contact",
    "us_az_state.state_supervision_period",
    "us_az_state.state_supervision_sentence",
    "us_az_state.state_supervision_violated_condition_entry",
    "us_az_state.state_supervision_violation",
    "us_az_state.state_supervision_violation_response",
    "us_az_state.state_supervision_violation_response_decision_entry",
    "us_az_state.state_supervision_violation_type_entry",
    "us_az_state.state_task_deadline",
    "us_ca_normalized_state.state_assessment",
    "us_ca_normalized_state.state_charge",
    "us_ca_normalized_state.state_charge_incarceration_sentence_association",
    "us_ca_normalized_state.state_charge_supervision_sentence_association",
    "us_ca_normalized_state.state_charge_v2",
    "us_ca_normalized_state.state_charge_v2_state_sentence_association",
    "us_ca_normalized_state.state_drug_screen",
    "us_ca_normalized_state.state_early_discharge",
    "us_ca_normalized_state.state_employment_period",
    "us_ca_normalized_state.state_incarceration_incident",
    "us_ca_normalized_state.state_incarceration_incident_outcome",
    "us_ca_normalized_state.state_incarceration_period",
    "us_ca_normalized_state.state_incarceration_sentence",
    "us_ca_normalized_state.state_person",
    "us_ca_normalized_state.state_person_address_period",
    "us_ca_normalized_state.state_person_alias",
    "us_ca_normalized_state.state_person_ethnicity",
    "us_ca_normalized_state.state_person_external_id",
    "us_ca_normalized_state.state_person_housing_status_period",
    "us_ca_normalized_state.state_person_race",
    "us_ca_normalized_state.state_program_assignment",
    "us_ca_normalized_state.state_sentence",
    "us_ca_normalized_state.state_sentence_group",
    "us_ca_normalized_state.state_sentence_group_length",
    "us_ca_normalized_state.state_sentence_inferred_group",
    "us_ca_normalized_state.state_sentence_length",
    "us_ca_normalized_state.state_sentence_status_snapshot",
    "us_ca_normalized_state.state_staff",
    "us_ca_normalized_state.state_staff_caseload_type_period",
    "us_ca_normalized_state.state_staff_external_id",
    "us_ca_normalized_state.state_staff_location_period",
    "us_ca_normalized_state.state_staff_role_period",
    "us_ca_normalized_state.state_staff_supervisor_period",
    "us_ca_normalized_state.state_supervision_case_type_entry",
    "us_ca_normalized_state.state_supervision_contact",
    "us_ca_normalized_state.state_supervision_period",
    "us_ca_normalized_state.state_supervision_sentence",
    "us_ca_normalized_state.state_supervision_violated_condition_entry",
    "us_ca_normalized_state.state_supervision_violation",
    "us_ca_normalized_state.state_supervision_violation_response",
    "us_ca_normalized_state.state_supervision_violation_response_decision_entry",
    "us_ca_normalized_state.state_supervision_violation_type_entry",
    "us_ca_normalized_state.state_task_deadline",
    "us_ca_state.state_assessment",
    "us_ca_state.state_charge",
    "us_ca_state.state_charge_incarceration_sentence_association",
    "us_ca_state.state_charge_supervision_sentence_association",
    "us_ca_state.state_charge_v2",
    "us_ca_state.state_charge_v2_state_sentence_association",
    "us_ca_state.state_drug_screen",
    "us_ca_state.state_early_discharge",
    "us_ca_state.state_employment_period",
    "us_ca_state.state_incarceration_incident",
    "us_ca_state.state_incarceration_incident_outcome",
    "us_ca_state.state_incarceration_period",
    "us_ca_state.state_incarceration_sentence",
    "us_ca_state.state_person",
    "us_ca_state.state_person_address_period",
    "us_ca_state.state_person_alias",
    "us_ca_state.state_person_ethnicity",
    "us_ca_state.state_person_external_id",
    "us_ca_state.state_person_housing_status_period",
    "us_ca_state.state_person_race",
    "us_ca_state.state_program_assignment",
    "us_ca_state.state_sentence",
    "us_ca_state.state_sentence_group",
    "us_ca_state.state_sentence_group_length",
    "us_ca_state.state_sentence_length",
    "us_ca_state.state_sentence_status_snapshot",
    "us_ca_state.state_staff",
    "us_ca_state.state_staff_caseload_type_period",
    "us_ca_state.state_staff_external_id",
    "us_ca_state.state_staff_location_period",
    "us_ca_state.state_staff_role_period",
    "us_ca_state.state_staff_supervisor_period",
    "us_ca_state.state_supervision_case_type_entry",
    "us_ca_state.state_supervision_contact",
    "us_ca_state.state_supervision_period",
    "us_ca_state.state_supervision_sentence",
    "us_ca_state.state_supervision_violated_condition_entry",
    "us_ca_state.state_supervision_violation",
    "us_ca_state.state_supervision_violation_response",
    "us_ca_state.state_supervision_violation_response_decision_entry",
    "us_ca_state.state_supervision_violation_type_entry",
    "us_ca_state.state_task_deadline",
    "us_co_normalized_state.state_assessment",
    "us_co_normalized_state.state_charge",
    "us_co_normalized_state.state_charge_incarceration_sentence_association",
    "us_co_normalized_state.state_charge_supervision_sentence_association",
    "us_co_normalized_state.state_charge_v2",
    "us_co_normalized_state.state_charge_v2_state_sentence_association",
    "us_co_normalized_state.state_drug_screen",
    "us_co_normalized_state.state_early_discharge",
    "us_co_normalized_state.state_employment_period",
    "us_co_normalized_state.state_incarceration_incident",
    "us_co_normalized_state.state_incarceration_incident_outcome",
    "us_co_normalized_state.state_incarceration_period",
    "us_co_normalized_state.state_incarceration_sentence",
    "us_co_normalized_state.state_person",
    "us_co_normalized_state.state_person_address_period",
    "us_co_normalized_state.state_person_alias",
    "us_co_normalized_state.state_person_ethnicity",
    "us_co_normalized_state.state_person_external_id",
    "us_co_normalized_state.state_person_housing_status_period",
    "us_co_normalized_state.state_person_race",
    "us_co_normalized_state.state_program_assignment",
    "us_co_normalized_state.state_sentence",
    "us_co_normalized_state.state_sentence_group",
    "us_co_normalized_state.state_sentence_group_length",
    "us_co_normalized_state.state_sentence_inferred_group",
    "us_co_normalized_state.state_sentence_length",
    "us_co_normalized_state.state_sentence_status_snapshot",
    "us_co_normalized_state.state_staff",
    "us_co_normalized_state.state_staff_caseload_type_period",
    "us_co_normalized_state.state_staff_external_id",
    "us_co_normalized_state.state_staff_location_period",
    "us_co_normalized_state.state_staff_role_period",
    "us_co_normalized_state.state_staff_supervisor_period",
    "us_co_normalized_state.state_supervision_case_type_entry",
    "us_co_normalized_state.state_supervision_contact",
    "us_co_normalized_state.state_supervision_period",
    "us_co_normalized_state.state_supervision_sentence",
    "us_co_normalized_state.state_supervision_violated_condition_entry",
    "us_co_normalized_state.state_supervision_violation",
    "us_co_normalized_state.state_supervision_violation_response",
    "us_co_normalized_state.state_supervision_violation_response_decision_entry",
    "us_co_normalized_state.state_supervision_violation_type_entry",
    "us_co_normalized_state.state_task_deadline",
    "us_co_state.state_assessment",
    "us_co_state.state_charge",
    "us_co_state.state_charge_incarceration_sentence_association",
    "us_co_state.state_charge_supervision_sentence_association",
    "us_co_state.state_charge_v2",
    "us_co_state.state_charge_v2_state_sentence_association",
    "us_co_state.state_drug_screen",
    "us_co_state.state_early_discharge",
    "us_co_state.state_employment_period",
    "us_co_state.state_incarceration_incident",
    "us_co_state.state_incarceration_incident_outcome",
    "us_co_state.state_incarceration_period",
    "us_co_state.state_incarceration_sentence",
    "us_co_state.state_person",
    "us_co_state.state_person_address_period",
    "us_co_state.state_person_alias",
    "us_co_state.state_person_ethnicity",
    "us_co_state.state_person_external_id",
    "us_co_state.state_person_housing_status_period",
    "us_co_state.state_person_race",
    "us_co_state.state_program_assignment",
    "us_co_state.state_sentence",
    "us_co_state.state_sentence_group",
    "us_co_state.state_sentence_group_length",
    "us_co_state.state_sentence_length",
    "us_co_state.state_sentence_status_snapshot",
    "us_co_state.state_staff",
    "us_co_state.state_staff_caseload_type_period",
    "us_co_state.state_staff_external_id",
    "us_co_state.state_staff_location_period",
    "us_co_state.state_staff_role_period",
    "us_co_state.state_staff_supervisor_period",
    "us_co_state.state_supervision_case_type_entry",
    "us_co_state.state_supervision_contact",
    "us_co_state.state_supervision_period",
    "us_co_state.state_supervision_sentence",
    "us_co_state.state_supervision_violated_condition_entry",
    "us_co_state.state_supervision_violation",
    "us_co_state.state_supervision_violation_response",
    "us_co_state.state_supervision_violation_response_decision_entry",
    "us_co_state.state_supervision_violation_type_entry",
    "us_co_state.state_task_deadline",
    "us_ia_normalized_state.state_assessment",
    "us_ia_normalized_state.state_charge",
    "us_ia_normalized_state.state_charge_incarceration_sentence_association",
    "us_ia_normalized_state.state_charge_supervision_sentence_association",
    "us_ia_normalized_state.state_charge_v2",
    "us_ia_normalized_state.state_charge_v2_state_sentence_association",
    "us_ia_normalized_state.state_drug_screen",
    "us_ia_normalized_state.state_early_discharge",
    "us_ia_normalized_state.state_employment_period",
    "us_ia_normalized_state.state_incarceration_incident",
    "us_ia_normalized_state.state_incarceration_incident_outcome",
    "us_ia_normalized_state.state_incarceration_period",
    "us_ia_normalized_state.state_incarceration_sentence",
    "us_ia_normalized_state.state_person",
    "us_ia_normalized_state.state_person_address_period",
    "us_ia_normalized_state.state_person_alias",
    "us_ia_normalized_state.state_person_ethnicity",
    "us_ia_normalized_state.state_person_external_id",
    "us_ia_normalized_state.state_person_housing_status_period",
    "us_ia_normalized_state.state_person_race",
    "us_ia_normalized_state.state_program_assignment",
    "us_ia_normalized_state.state_sentence",
    "us_ia_normalized_state.state_sentence_group",
    "us_ia_normalized_state.state_sentence_group_length",
    "us_ia_normalized_state.state_sentence_inferred_group",
    "us_ia_normalized_state.state_sentence_length",
    "us_ia_normalized_state.state_sentence_status_snapshot",
    "us_ia_normalized_state.state_staff",
    "us_ia_normalized_state.state_staff_caseload_type_period",
    "us_ia_normalized_state.state_staff_external_id",
    "us_ia_normalized_state.state_staff_location_period",
    "us_ia_normalized_state.state_staff_role_period",
    "us_ia_normalized_state.state_staff_supervisor_period",
    "us_ia_normalized_state.state_supervision_case_type_entry",
    "us_ia_normalized_state.state_supervision_contact",
    "us_ia_normalized_state.state_supervision_period",
    "us_ia_normalized_state.state_supervision_sentence",
    "us_ia_normalized_state.state_supervision_violated_condition_entry",
    "us_ia_normalized_state.state_supervision_violation",
    "us_ia_normalized_state.state_supervision_violation_response",
    "us_ia_normalized_state.state_supervision_violation_response_decision_entry",
    "us_ia_normalized_state.state_supervision_violation_type_entry",
    "us_ia_normalized_state.state_task_deadline",
    "us_ia_state.state_assessment",
    "us_ia_state.state_charge",
    "us_ia_state.state_charge_incarceration_sentence_association",
    "us_ia_state.state_charge_supervision_sentence_association",
    "us_ia_state.state_charge_v2",
    "us_ia_state.state_charge_v2_state_sentence_association",
    "us_ia_state.state_drug_screen",
    "us_ia_state.state_early_discharge",
    "us_ia_state.state_employment_period",
    "us_ia_state.state_incarceration_incident",
    "us_ia_state.state_incarceration_incident_outcome",
    "us_ia_state.state_incarceration_period",
    "us_ia_state.state_incarceration_sentence",
    "us_ia_state.state_person",
    "us_ia_state.state_person_address_period",
    "us_ia_state.state_person_alias",
    "us_ia_state.state_person_ethnicity",
    "us_ia_state.state_person_external_id",
    "us_ia_state.state_person_housing_status_period",
    "us_ia_state.state_person_race",
    "us_ia_state.state_program_assignment",
    "us_ia_state.state_sentence",
    "us_ia_state.state_sentence_group",
    "us_ia_state.state_sentence_group_length",
    "us_ia_state.state_sentence_length",
    "us_ia_state.state_sentence_status_snapshot",
    "us_ia_state.state_staff",
    "us_ia_state.state_staff_caseload_type_period",
    "us_ia_state.state_staff_external_id",
    "us_ia_state.state_staff_location_period",
    "us_ia_state.state_staff_role_period",
    "us_ia_state.state_staff_supervisor_period",
    "us_ia_state.state_supervision_case_type_entry",
    "us_ia_state.state_supervision_contact",
    "us_ia_state.state_supervision_period",
    "us_ia_state.state_supervision_sentence",
    "us_ia_state.state_supervision_violated_condition_entry",
    "us_ia_state.state_supervision_violation",
    "us_ia_state.state_supervision_violation_response",
    "us_ia_state.state_supervision_violation_response_decision_entry",
    "us_ia_state.state_supervision_violation_type_entry",
    "us_ia_state.state_task_deadline",
    "us_id_normalized_state.state_assessment",
    "us_id_normalized_state.state_charge",
    "us_id_normalized_state.state_charge_incarceration_sentence_association",
    "us_id_normalized_state.state_charge_supervision_sentence_association",
    "us_id_normalized_state.state_charge_v2",
    "us_id_normalized_state.state_charge_v2_state_sentence_association",
    "us_id_normalized_state.state_drug_screen",
    "us_id_normalized_state.state_early_discharge",
    "us_id_normalized_state.state_employment_period",
    "us_id_normalized_state.state_incarceration_incident",
    "us_id_normalized_state.state_incarceration_incident_outcome",
    "us_id_normalized_state.state_incarceration_period",
    "us_id_normalized_state.state_incarceration_sentence",
    "us_id_normalized_state.state_person",
    "us_id_normalized_state.state_person_address_period",
    "us_id_normalized_state.state_person_alias",
    "us_id_normalized_state.state_person_ethnicity",
    "us_id_normalized_state.state_person_external_id",
    "us_id_normalized_state.state_person_housing_status_period",
    "us_id_normalized_state.state_person_race",
    "us_id_normalized_state.state_program_assignment",
    "us_id_normalized_state.state_sentence",
    "us_id_normalized_state.state_sentence_group",
    "us_id_normalized_state.state_sentence_group_length",
    "us_id_normalized_state.state_sentence_inferred_group",
    "us_id_normalized_state.state_sentence_length",
    "us_id_normalized_state.state_sentence_status_snapshot",
    "us_id_normalized_state.state_staff",
    "us_id_normalized_state.state_staff_caseload_type_period",
    "us_id_normalized_state.state_staff_external_id",
    "us_id_normalized_state.state_staff_location_period",
    "us_id_normalized_state.state_staff_role_period",
    "us_id_normalized_state.state_staff_supervisor_period",
    "us_id_normalized_state.state_supervision_case_type_entry",
    "us_id_normalized_state.state_supervision_contact",
    "us_id_normalized_state.state_supervision_period",
    "us_id_normalized_state.state_supervision_sentence",
    "us_id_normalized_state.state_supervision_violated_condition_entry",
    "us_id_normalized_state.state_supervision_violation",
    "us_id_normalized_state.state_supervision_violation_response",
    "us_id_normalized_state.state_supervision_violation_response_decision_entry",
    "us_id_normalized_state.state_supervision_violation_type_entry",
    "us_id_normalized_state.state_task_deadline",
    "us_id_state.state_assessment",
    "us_id_state.state_charge",
    "us_id_state.state_charge_incarceration_sentence_association",
    "us_id_state.state_charge_supervision_sentence_association",
    "us_id_state.state_charge_v2",
    "us_id_state.state_charge_v2_state_sentence_association",
    "us_id_state.state_drug_screen",
    "us_id_state.state_early_discharge",
    "us_id_state.state_employment_period",
    "us_id_state.state_incarceration_incident",
    "us_id_state.state_incarceration_incident_outcome",
    "us_id_state.state_incarceration_period",
    "us_id_state.state_incarceration_sentence",
    "us_id_state.state_person",
    "us_id_state.state_person_address_period",
    "us_id_state.state_person_alias",
    "us_id_state.state_person_ethnicity",
    "us_id_state.state_person_external_id",
    "us_id_state.state_person_housing_status_period",
    "us_id_state.state_person_race",
    "us_id_state.state_program_assignment",
    "us_id_state.state_sentence",
    "us_id_state.state_sentence_group",
    "us_id_state.state_sentence_group_length",
    "us_id_state.state_sentence_length",
    "us_id_state.state_sentence_status_snapshot",
    "us_id_state.state_staff",
    "us_id_state.state_staff_caseload_type_period",
    "us_id_state.state_staff_external_id",
    "us_id_state.state_staff_location_period",
    "us_id_state.state_staff_role_period",
    "us_id_state.state_staff_supervisor_period",
    "us_id_state.state_supervision_case_type_entry",
    "us_id_state.state_supervision_contact",
    "us_id_state.state_supervision_period",
    "us_id_state.state_supervision_sentence",
    "us_id_state.state_supervision_violated_condition_entry",
    "us_id_state.state_supervision_violation",
    "us_id_state.state_supervision_violation_response",
    "us_id_state.state_supervision_violation_response_decision_entry",
    "us_id_state.state_supervision_violation_type_entry",
    "us_id_state.state_task_deadline",
    "us_ix_normalized_state.state_assessment",
    "us_ix_normalized_state.state_charge",
    "us_ix_normalized_state.state_charge_incarceration_sentence_association",
    "us_ix_normalized_state.state_charge_supervision_sentence_association",
    "us_ix_normalized_state.state_charge_v2",
    "us_ix_normalized_state.state_charge_v2_state_sentence_association",
    "us_ix_normalized_state.state_drug_screen",
    "us_ix_normalized_state.state_early_discharge",
    "us_ix_normalized_state.state_employment_period",
    "us_ix_normalized_state.state_incarceration_incident",
    "us_ix_normalized_state.state_incarceration_incident_outcome",
    "us_ix_normalized_state.state_incarceration_period",
    "us_ix_normalized_state.state_incarceration_sentence",
    "us_ix_normalized_state.state_person",
    "us_ix_normalized_state.state_person_address_period",
    "us_ix_normalized_state.state_person_alias",
    "us_ix_normalized_state.state_person_ethnicity",
    "us_ix_normalized_state.state_person_external_id",
    "us_ix_normalized_state.state_person_housing_status_period",
    "us_ix_normalized_state.state_person_race",
    "us_ix_normalized_state.state_program_assignment",
    "us_ix_normalized_state.state_sentence",
    "us_ix_normalized_state.state_sentence_group",
    "us_ix_normalized_state.state_sentence_group_length",
    "us_ix_normalized_state.state_sentence_inferred_group",
    "us_ix_normalized_state.state_sentence_length",
    "us_ix_normalized_state.state_sentence_status_snapshot",
    "us_ix_normalized_state.state_staff",
    "us_ix_normalized_state.state_staff_caseload_type_period",
    "us_ix_normalized_state.state_staff_external_id",
    "us_ix_normalized_state.state_staff_location_period",
    "us_ix_normalized_state.state_staff_role_period",
    "us_ix_normalized_state.state_staff_supervisor_period",
    "us_ix_normalized_state.state_supervision_case_type_entry",
    "us_ix_normalized_state.state_supervision_contact",
    "us_ix_normalized_state.state_supervision_period",
    "us_ix_normalized_state.state_supervision_sentence",
    "us_ix_normalized_state.state_supervision_violated_condition_entry",
    "us_ix_normalized_state.state_supervision_violation",
    "us_ix_normalized_state.state_supervision_violation_response",
    "us_ix_normalized_state.state_supervision_violation_response_decision_entry",
    "us_ix_normalized_state.state_supervision_violation_type_entry",
    "us_ix_normalized_state.state_task_deadline",
    "us_ix_state.state_assessment",
    "us_ix_state.state_charge",
    "us_ix_state.state_charge_incarceration_sentence_association",
    "us_ix_state.state_charge_supervision_sentence_association",
    "us_ix_state.state_charge_v2",
    "us_ix_state.state_charge_v2_state_sentence_association",
    "us_ix_state.state_drug_screen",
    "us_ix_state.state_early_discharge",
    "us_ix_state.state_employment_period",
    "us_ix_state.state_incarceration_incident",
    "us_ix_state.state_incarceration_incident_outcome",
    "us_ix_state.state_incarceration_period",
    "us_ix_state.state_incarceration_sentence",
    "us_ix_state.state_person",
    "us_ix_state.state_person_address_period",
    "us_ix_state.state_person_alias",
    "us_ix_state.state_person_ethnicity",
    "us_ix_state.state_person_external_id",
    "us_ix_state.state_person_housing_status_period",
    "us_ix_state.state_person_race",
    "us_ix_state.state_program_assignment",
    "us_ix_state.state_sentence",
    "us_ix_state.state_sentence_group",
    "us_ix_state.state_sentence_group_length",
    "us_ix_state.state_sentence_length",
    "us_ix_state.state_sentence_status_snapshot",
    "us_ix_state.state_staff",
    "us_ix_state.state_staff_caseload_type_period",
    "us_ix_state.state_staff_external_id",
    "us_ix_state.state_staff_location_period",
    "us_ix_state.state_staff_role_period",
    "us_ix_state.state_staff_supervisor_period",
    "us_ix_state.state_supervision_case_type_entry",
    "us_ix_state.state_supervision_contact",
    "us_ix_state.state_supervision_period",
    "us_ix_state.state_supervision_sentence",
    "us_ix_state.state_supervision_violated_condition_entry",
    "us_ix_state.state_supervision_violation",
    "us_ix_state.state_supervision_violation_response",
    "us_ix_state.state_supervision_violation_response_decision_entry",
    "us_ix_state.state_supervision_violation_type_entry",
    "us_ix_state.state_task_deadline",
    "us_ma_normalized_state.state_assessment",
    "us_ma_normalized_state.state_charge",
    "us_ma_normalized_state.state_charge_incarceration_sentence_association",
    "us_ma_normalized_state.state_charge_supervision_sentence_association",
    "us_ma_normalized_state.state_charge_v2",
    "us_ma_normalized_state.state_charge_v2_state_sentence_association",
    "us_ma_normalized_state.state_drug_screen",
    "us_ma_normalized_state.state_early_discharge",
    "us_ma_normalized_state.state_employment_period",
    "us_ma_normalized_state.state_incarceration_incident",
    "us_ma_normalized_state.state_incarceration_incident_outcome",
    "us_ma_normalized_state.state_incarceration_period",
    "us_ma_normalized_state.state_incarceration_sentence",
    "us_ma_normalized_state.state_person",
    "us_ma_normalized_state.state_person_address_period",
    "us_ma_normalized_state.state_person_alias",
    "us_ma_normalized_state.state_person_ethnicity",
    "us_ma_normalized_state.state_person_external_id",
    "us_ma_normalized_state.state_person_housing_status_period",
    "us_ma_normalized_state.state_person_race",
    "us_ma_normalized_state.state_program_assignment",
    "us_ma_normalized_state.state_sentence",
    "us_ma_normalized_state.state_sentence_group",
    "us_ma_normalized_state.state_sentence_group_length",
    "us_ma_normalized_state.state_sentence_inferred_group",
    "us_ma_normalized_state.state_sentence_length",
    "us_ma_normalized_state.state_sentence_status_snapshot",
    "us_ma_normalized_state.state_staff",
    "us_ma_normalized_state.state_staff_caseload_type_period",
    "us_ma_normalized_state.state_staff_external_id",
    "us_ma_normalized_state.state_staff_location_period",
    "us_ma_normalized_state.state_staff_role_period",
    "us_ma_normalized_state.state_staff_supervisor_period",
    "us_ma_normalized_state.state_supervision_case_type_entry",
    "us_ma_normalized_state.state_supervision_contact",
    "us_ma_normalized_state.state_supervision_period",
    "us_ma_normalized_state.state_supervision_sentence",
    "us_ma_normalized_state.state_supervision_violated_condition_entry",
    "us_ma_normalized_state.state_supervision_violation",
    "us_ma_normalized_state.state_supervision_violation_response",
    "us_ma_normalized_state.state_supervision_violation_response_decision_entry",
    "us_ma_normalized_state.state_supervision_violation_type_entry",
    "us_ma_normalized_state.state_task_deadline",
    "us_ma_state.state_assessment",
    "us_ma_state.state_charge",
    "us_ma_state.state_charge_incarceration_sentence_association",
    "us_ma_state.state_charge_supervision_sentence_association",
    "us_ma_state.state_charge_v2",
    "us_ma_state.state_charge_v2_state_sentence_association",
    "us_ma_state.state_drug_screen",
    "us_ma_state.state_early_discharge",
    "us_ma_state.state_employment_period",
    "us_ma_state.state_incarceration_incident",
    "us_ma_state.state_incarceration_incident_outcome",
    "us_ma_state.state_incarceration_period",
    "us_ma_state.state_incarceration_sentence",
    "us_ma_state.state_person",
    "us_ma_state.state_person_address_period",
    "us_ma_state.state_person_alias",
    "us_ma_state.state_person_ethnicity",
    "us_ma_state.state_person_external_id",
    "us_ma_state.state_person_housing_status_period",
    "us_ma_state.state_person_race",
    "us_ma_state.state_program_assignment",
    "us_ma_state.state_sentence",
    "us_ma_state.state_sentence_group",
    "us_ma_state.state_sentence_group_length",
    "us_ma_state.state_sentence_length",
    "us_ma_state.state_sentence_status_snapshot",
    "us_ma_state.state_staff",
    "us_ma_state.state_staff_caseload_type_period",
    "us_ma_state.state_staff_external_id",
    "us_ma_state.state_staff_location_period",
    "us_ma_state.state_staff_role_period",
    "us_ma_state.state_staff_supervisor_period",
    "us_ma_state.state_supervision_case_type_entry",
    "us_ma_state.state_supervision_contact",
    "us_ma_state.state_supervision_period",
    "us_ma_state.state_supervision_sentence",
    "us_ma_state.state_supervision_violated_condition_entry",
    "us_ma_state.state_supervision_violation",
    "us_ma_state.state_supervision_violation_response",
    "us_ma_state.state_supervision_violation_response_decision_entry",
    "us_ma_state.state_supervision_violation_type_entry",
    "us_ma_state.state_task_deadline",
    "us_me_normalized_state.state_assessment",
    "us_me_normalized_state.state_charge",
    "us_me_normalized_state.state_charge_incarceration_sentence_association",
    "us_me_normalized_state.state_charge_supervision_sentence_association",
    "us_me_normalized_state.state_charge_v2",
    "us_me_normalized_state.state_charge_v2_state_sentence_association",
    "us_me_normalized_state.state_drug_screen",
    "us_me_normalized_state.state_early_discharge",
    "us_me_normalized_state.state_employment_period",
    "us_me_normalized_state.state_incarceration_incident",
    "us_me_normalized_state.state_incarceration_incident_outcome",
    "us_me_normalized_state.state_incarceration_period",
    "us_me_normalized_state.state_incarceration_sentence",
    "us_me_normalized_state.state_person",
    "us_me_normalized_state.state_person_address_period",
    "us_me_normalized_state.state_person_alias",
    "us_me_normalized_state.state_person_ethnicity",
    "us_me_normalized_state.state_person_external_id",
    "us_me_normalized_state.state_person_housing_status_period",
    "us_me_normalized_state.state_person_race",
    "us_me_normalized_state.state_program_assignment",
    "us_me_normalized_state.state_sentence",
    "us_me_normalized_state.state_sentence_group",
    "us_me_normalized_state.state_sentence_group_length",
    "us_me_normalized_state.state_sentence_inferred_group",
    "us_me_normalized_state.state_sentence_length",
    "us_me_normalized_state.state_sentence_status_snapshot",
    "us_me_normalized_state.state_staff",
    "us_me_normalized_state.state_staff_caseload_type_period",
    "us_me_normalized_state.state_staff_external_id",
    "us_me_normalized_state.state_staff_location_period",
    "us_me_normalized_state.state_staff_role_period",
    "us_me_normalized_state.state_staff_supervisor_period",
    "us_me_normalized_state.state_supervision_case_type_entry",
    "us_me_normalized_state.state_supervision_contact",
    "us_me_normalized_state.state_supervision_period",
    "us_me_normalized_state.state_supervision_sentence",
    "us_me_normalized_state.state_supervision_violated_condition_entry",
    "us_me_normalized_state.state_supervision_violation",
    "us_me_normalized_state.state_supervision_violation_response",
    "us_me_normalized_state.state_supervision_violation_response_decision_entry",
    "us_me_normalized_state.state_supervision_violation_type_entry",
    "us_me_normalized_state.state_task_deadline",
    "us_me_state.state_assessment",
    "us_me_state.state_charge",
    "us_me_state.state_charge_incarceration_sentence_association",
    "us_me_state.state_charge_supervision_sentence_association",
    "us_me_state.state_charge_v2",
    "us_me_state.state_charge_v2_state_sentence_association",
    "us_me_state.state_drug_screen",
    "us_me_state.state_early_discharge",
    "us_me_state.state_employment_period",
    "us_me_state.state_incarceration_incident",
    "us_me_state.state_incarceration_incident_outcome",
    "us_me_state.state_incarceration_period",
    "us_me_state.state_incarceration_sentence",
    "us_me_state.state_person",
    "us_me_state.state_person_address_period",
    "us_me_state.state_person_alias",
    "us_me_state.state_person_ethnicity",
    "us_me_state.state_person_external_id",
    "us_me_state.state_person_housing_status_period",
    "us_me_state.state_person_race",
    "us_me_state.state_program_assignment",
    "us_me_state.state_sentence",
    "us_me_state.state_sentence_group",
    "us_me_state.state_sentence_group_length",
    "us_me_state.state_sentence_length",
    "us_me_state.state_sentence_status_snapshot",
    "us_me_state.state_staff",
    "us_me_state.state_staff_caseload_type_period",
    "us_me_state.state_staff_external_id",
    "us_me_state.state_staff_location_period",
    "us_me_state.state_staff_role_period",
    "us_me_state.state_staff_supervisor_period",
    "us_me_state.state_supervision_case_type_entry",
    "us_me_state.state_supervision_contact",
    "us_me_state.state_supervision_period",
    "us_me_state.state_supervision_sentence",
    "us_me_state.state_supervision_violated_condition_entry",
    "us_me_state.state_supervision_violation",
    "us_me_state.state_supervision_violation_response",
    "us_me_state.state_supervision_violation_response_decision_entry",
    "us_me_state.state_supervision_violation_type_entry",
    "us_me_state.state_task_deadline",
    "us_mi_normalized_state.state_assessment",
    "us_mi_normalized_state.state_charge",
    "us_mi_normalized_state.state_charge_incarceration_sentence_association",
    "us_mi_normalized_state.state_charge_supervision_sentence_association",
    "us_mi_normalized_state.state_charge_v2",
    "us_mi_normalized_state.state_charge_v2_state_sentence_association",
    "us_mi_normalized_state.state_drug_screen",
    "us_mi_normalized_state.state_early_discharge",
    "us_mi_normalized_state.state_employment_period",
    "us_mi_normalized_state.state_incarceration_incident",
    "us_mi_normalized_state.state_incarceration_incident_outcome",
    "us_mi_normalized_state.state_incarceration_period",
    "us_mi_normalized_state.state_incarceration_sentence",
    "us_mi_normalized_state.state_person",
    "us_mi_normalized_state.state_person_address_period",
    "us_mi_normalized_state.state_person_alias",
    "us_mi_normalized_state.state_person_ethnicity",
    "us_mi_normalized_state.state_person_external_id",
    "us_mi_normalized_state.state_person_housing_status_period",
    "us_mi_normalized_state.state_person_race",
    "us_mi_normalized_state.state_program_assignment",
    "us_mi_normalized_state.state_sentence",
    "us_mi_normalized_state.state_sentence_group",
    "us_mi_normalized_state.state_sentence_group_length",
    "us_mi_normalized_state.state_sentence_inferred_group",
    "us_mi_normalized_state.state_sentence_length",
    "us_mi_normalized_state.state_sentence_status_snapshot",
    "us_mi_normalized_state.state_staff",
    "us_mi_normalized_state.state_staff_caseload_type_period",
    "us_mi_normalized_state.state_staff_external_id",
    "us_mi_normalized_state.state_staff_location_period",
    "us_mi_normalized_state.state_staff_role_period",
    "us_mi_normalized_state.state_staff_supervisor_period",
    "us_mi_normalized_state.state_supervision_case_type_entry",
    "us_mi_normalized_state.state_supervision_contact",
    "us_mi_normalized_state.state_supervision_period",
    "us_mi_normalized_state.state_supervision_sentence",
    "us_mi_normalized_state.state_supervision_violated_condition_entry",
    "us_mi_normalized_state.state_supervision_violation",
    "us_mi_normalized_state.state_supervision_violation_response",
    "us_mi_normalized_state.state_supervision_violation_response_decision_entry",
    "us_mi_normalized_state.state_supervision_violation_type_entry",
    "us_mi_normalized_state.state_task_deadline",
    "us_mi_state.state_assessment",
    "us_mi_state.state_charge",
    "us_mi_state.state_charge_incarceration_sentence_association",
    "us_mi_state.state_charge_supervision_sentence_association",
    "us_mi_state.state_charge_v2",
    "us_mi_state.state_charge_v2_state_sentence_association",
    "us_mi_state.state_drug_screen",
    "us_mi_state.state_early_discharge",
    "us_mi_state.state_employment_period",
    "us_mi_state.state_incarceration_incident",
    "us_mi_state.state_incarceration_incident_outcome",
    "us_mi_state.state_incarceration_period",
    "us_mi_state.state_incarceration_sentence",
    "us_mi_state.state_person",
    "us_mi_state.state_person_address_period",
    "us_mi_state.state_person_alias",
    "us_mi_state.state_person_ethnicity",
    "us_mi_state.state_person_external_id",
    "us_mi_state.state_person_housing_status_period",
    "us_mi_state.state_person_race",
    "us_mi_state.state_program_assignment",
    "us_mi_state.state_sentence",
    "us_mi_state.state_sentence_group",
    "us_mi_state.state_sentence_group_length",
    "us_mi_state.state_sentence_length",
    "us_mi_state.state_sentence_status_snapshot",
    "us_mi_state.state_staff",
    "us_mi_state.state_staff_caseload_type_period",
    "us_mi_state.state_staff_external_id",
    "us_mi_state.state_staff_location_period",
    "us_mi_state.state_staff_role_period",
    "us_mi_state.state_staff_supervisor_period",
    "us_mi_state.state_supervision_case_type_entry",
    "us_mi_state.state_supervision_contact",
    "us_mi_state.state_supervision_period",
    "us_mi_state.state_supervision_sentence",
    "us_mi_state.state_supervision_violated_condition_entry",
    "us_mi_state.state_supervision_violation",
    "us_mi_state.state_supervision_violation_response",
    "us_mi_state.state_supervision_violation_response_decision_entry",
    "us_mi_state.state_supervision_violation_type_entry",
    "us_mi_state.state_task_deadline",
    "us_mo_normalized_state.state_assessment",
    "us_mo_normalized_state.state_charge",
    "us_mo_normalized_state.state_charge_incarceration_sentence_association",
    "us_mo_normalized_state.state_charge_supervision_sentence_association",
    "us_mo_normalized_state.state_charge_v2",
    "us_mo_normalized_state.state_charge_v2_state_sentence_association",
    "us_mo_normalized_state.state_drug_screen",
    "us_mo_normalized_state.state_early_discharge",
    "us_mo_normalized_state.state_employment_period",
    "us_mo_normalized_state.state_incarceration_incident",
    "us_mo_normalized_state.state_incarceration_incident_outcome",
    "us_mo_normalized_state.state_incarceration_period",
    "us_mo_normalized_state.state_incarceration_sentence",
    "us_mo_normalized_state.state_person",
    "us_mo_normalized_state.state_person_address_period",
    "us_mo_normalized_state.state_person_alias",
    "us_mo_normalized_state.state_person_ethnicity",
    "us_mo_normalized_state.state_person_external_id",
    "us_mo_normalized_state.state_person_housing_status_period",
    "us_mo_normalized_state.state_person_race",
    "us_mo_normalized_state.state_program_assignment",
    "us_mo_normalized_state.state_sentence",
    "us_mo_normalized_state.state_sentence_group",
    "us_mo_normalized_state.state_sentence_group_length",
    "us_mo_normalized_state.state_sentence_inferred_group",
    "us_mo_normalized_state.state_sentence_length",
    "us_mo_normalized_state.state_sentence_status_snapshot",
    "us_mo_normalized_state.state_staff",
    "us_mo_normalized_state.state_staff_caseload_type_period",
    "us_mo_normalized_state.state_staff_external_id",
    "us_mo_normalized_state.state_staff_location_period",
    "us_mo_normalized_state.state_staff_role_period",
    "us_mo_normalized_state.state_staff_supervisor_period",
    "us_mo_normalized_state.state_supervision_case_type_entry",
    "us_mo_normalized_state.state_supervision_contact",
    "us_mo_normalized_state.state_supervision_period",
    "us_mo_normalized_state.state_supervision_sentence",
    "us_mo_normalized_state.state_supervision_violated_condition_entry",
    "us_mo_normalized_state.state_supervision_violation",
    "us_mo_normalized_state.state_supervision_violation_response",
    "us_mo_normalized_state.state_supervision_violation_response_decision_entry",
    "us_mo_normalized_state.state_supervision_violation_type_entry",
    "us_mo_normalized_state.state_task_deadline",
    "us_mo_state.state_assessment",
    "us_mo_state.state_charge",
    "us_mo_state.state_charge_incarceration_sentence_association",
    "us_mo_state.state_charge_supervision_sentence_association",
    "us_mo_state.state_charge_v2",
    "us_mo_state.state_charge_v2_state_sentence_association",
    "us_mo_state.state_drug_screen",
    "us_mo_state.state_early_discharge",
    "us_mo_state.state_employment_period",
    "us_mo_state.state_incarceration_incident",
    "us_mo_state.state_incarceration_incident_outcome",
    "us_mo_state.state_incarceration_period",
    "us_mo_state.state_incarceration_sentence",
    "us_mo_state.state_person",
    "us_mo_state.state_person_address_period",
    "us_mo_state.state_person_alias",
    "us_mo_state.state_person_ethnicity",
    "us_mo_state.state_person_external_id",
    "us_mo_state.state_person_housing_status_period",
    "us_mo_state.state_person_race",
    "us_mo_state.state_program_assignment",
    "us_mo_state.state_sentence",
    "us_mo_state.state_sentence_group",
    "us_mo_state.state_sentence_group_length",
    "us_mo_state.state_sentence_length",
    "us_mo_state.state_sentence_status_snapshot",
    "us_mo_state.state_staff",
    "us_mo_state.state_staff_caseload_type_period",
    "us_mo_state.state_staff_external_id",
    "us_mo_state.state_staff_location_period",
    "us_mo_state.state_staff_role_period",
    "us_mo_state.state_staff_supervisor_period",
    "us_mo_state.state_supervision_case_type_entry",
    "us_mo_state.state_supervision_contact",
    "us_mo_state.state_supervision_period",
    "us_mo_state.state_supervision_sentence",
    "us_mo_state.state_supervision_violated_condition_entry",
    "us_mo_state.state_supervision_violation",
    "us_mo_state.state_supervision_violation_response",
    "us_mo_state.state_supervision_violation_response_decision_entry",
    "us_mo_state.state_supervision_violation_type_entry",
    "us_mo_state.state_task_deadline",
    "us_nc_normalized_state.state_assessment",
    "us_nc_normalized_state.state_charge",
    "us_nc_normalized_state.state_charge_incarceration_sentence_association",
    "us_nc_normalized_state.state_charge_supervision_sentence_association",
    "us_nc_normalized_state.state_charge_v2",
    "us_nc_normalized_state.state_charge_v2_state_sentence_association",
    "us_nc_normalized_state.state_drug_screen",
    "us_nc_normalized_state.state_early_discharge",
    "us_nc_normalized_state.state_employment_period",
    "us_nc_normalized_state.state_incarceration_incident",
    "us_nc_normalized_state.state_incarceration_incident_outcome",
    "us_nc_normalized_state.state_incarceration_period",
    "us_nc_normalized_state.state_incarceration_sentence",
    "us_nc_normalized_state.state_person",
    "us_nc_normalized_state.state_person_address_period",
    "us_nc_normalized_state.state_person_alias",
    "us_nc_normalized_state.state_person_ethnicity",
    "us_nc_normalized_state.state_person_external_id",
    "us_nc_normalized_state.state_person_housing_status_period",
    "us_nc_normalized_state.state_person_race",
    "us_nc_normalized_state.state_program_assignment",
    "us_nc_normalized_state.state_sentence",
    "us_nc_normalized_state.state_sentence_group",
    "us_nc_normalized_state.state_sentence_group_length",
    "us_nc_normalized_state.state_sentence_inferred_group",
    "us_nc_normalized_state.state_sentence_length",
    "us_nc_normalized_state.state_sentence_status_snapshot",
    "us_nc_normalized_state.state_staff",
    "us_nc_normalized_state.state_staff_caseload_type_period",
    "us_nc_normalized_state.state_staff_external_id",
    "us_nc_normalized_state.state_staff_location_period",
    "us_nc_normalized_state.state_staff_role_period",
    "us_nc_normalized_state.state_staff_supervisor_period",
    "us_nc_normalized_state.state_supervision_case_type_entry",
    "us_nc_normalized_state.state_supervision_contact",
    "us_nc_normalized_state.state_supervision_period",
    "us_nc_normalized_state.state_supervision_sentence",
    "us_nc_normalized_state.state_supervision_violated_condition_entry",
    "us_nc_normalized_state.state_supervision_violation",
    "us_nc_normalized_state.state_supervision_violation_response",
    "us_nc_normalized_state.state_supervision_violation_response_decision_entry",
    "us_nc_normalized_state.state_supervision_violation_type_entry",
    "us_nc_normalized_state.state_task_deadline",
    "us_nc_state.state_assessment",
    "us_nc_state.state_charge",
    "us_nc_state.state_charge_incarceration_sentence_association",
    "us_nc_state.state_charge_supervision_sentence_association",
    "us_nc_state.state_charge_v2",
    "us_nc_state.state_charge_v2_state_sentence_association",
    "us_nc_state.state_drug_screen",
    "us_nc_state.state_early_discharge",
    "us_nc_state.state_employment_period",
    "us_nc_state.state_incarceration_incident",
    "us_nc_state.state_incarceration_incident_outcome",
    "us_nc_state.state_incarceration_period",
    "us_nc_state.state_incarceration_sentence",
    "us_nc_state.state_person",
    "us_nc_state.state_person_address_period",
    "us_nc_state.state_person_alias",
    "us_nc_state.state_person_ethnicity",
    "us_nc_state.state_person_external_id",
    "us_nc_state.state_person_housing_status_period",
    "us_nc_state.state_person_race",
    "us_nc_state.state_program_assignment",
    "us_nc_state.state_sentence",
    "us_nc_state.state_sentence_group",
    "us_nc_state.state_sentence_group_length",
    "us_nc_state.state_sentence_length",
    "us_nc_state.state_sentence_status_snapshot",
    "us_nc_state.state_staff",
    "us_nc_state.state_staff_caseload_type_period",
    "us_nc_state.state_staff_external_id",
    "us_nc_state.state_staff_location_period",
    "us_nc_state.state_staff_role_period",
    "us_nc_state.state_staff_supervisor_period",
    "us_nc_state.state_supervision_case_type_entry",
    "us_nc_state.state_supervision_contact",
    "us_nc_state.state_supervision_period",
    "us_nc_state.state_supervision_sentence",
    "us_nc_state.state_supervision_violated_condition_entry",
    "us_nc_state.state_supervision_violation",
    "us_nc_state.state_supervision_violation_response",
    "us_nc_state.state_supervision_violation_response_decision_entry",
    "us_nc_state.state_supervision_violation_type_entry",
    "us_nc_state.state_task_deadline",
    "us_nd_normalized_state.state_assessment",
    "us_nd_normalized_state.state_charge",
    "us_nd_normalized_state.state_charge_incarceration_sentence_association",
    "us_nd_normalized_state.state_charge_supervision_sentence_association",
    "us_nd_normalized_state.state_charge_v2",
    "us_nd_normalized_state.state_charge_v2_state_sentence_association",
    "us_nd_normalized_state.state_drug_screen",
    "us_nd_normalized_state.state_early_discharge",
    "us_nd_normalized_state.state_employment_period",
    "us_nd_normalized_state.state_incarceration_incident",
    "us_nd_normalized_state.state_incarceration_incident_outcome",
    "us_nd_normalized_state.state_incarceration_period",
    "us_nd_normalized_state.state_incarceration_sentence",
    "us_nd_normalized_state.state_person",
    "us_nd_normalized_state.state_person_address_period",
    "us_nd_normalized_state.state_person_alias",
    "us_nd_normalized_state.state_person_ethnicity",
    "us_nd_normalized_state.state_person_external_id",
    "us_nd_normalized_state.state_person_housing_status_period",
    "us_nd_normalized_state.state_person_race",
    "us_nd_normalized_state.state_program_assignment",
    "us_nd_normalized_state.state_sentence",
    "us_nd_normalized_state.state_sentence_group",
    "us_nd_normalized_state.state_sentence_group_length",
    "us_nd_normalized_state.state_sentence_inferred_group",
    "us_nd_normalized_state.state_sentence_length",
    "us_nd_normalized_state.state_sentence_status_snapshot",
    "us_nd_normalized_state.state_staff",
    "us_nd_normalized_state.state_staff_caseload_type_period",
    "us_nd_normalized_state.state_staff_external_id",
    "us_nd_normalized_state.state_staff_location_period",
    "us_nd_normalized_state.state_staff_role_period",
    "us_nd_normalized_state.state_staff_supervisor_period",
    "us_nd_normalized_state.state_supervision_case_type_entry",
    "us_nd_normalized_state.state_supervision_contact",
    "us_nd_normalized_state.state_supervision_period",
    "us_nd_normalized_state.state_supervision_sentence",
    "us_nd_normalized_state.state_supervision_violated_condition_entry",
    "us_nd_normalized_state.state_supervision_violation",
    "us_nd_normalized_state.state_supervision_violation_response",
    "us_nd_normalized_state.state_supervision_violation_response_decision_entry",
    "us_nd_normalized_state.state_supervision_violation_type_entry",
    "us_nd_normalized_state.state_task_deadline",
    "us_nd_state.state_assessment",
    "us_nd_state.state_charge",
    "us_nd_state.state_charge_incarceration_sentence_association",
    "us_nd_state.state_charge_supervision_sentence_association",
    "us_nd_state.state_charge_v2",
    "us_nd_state.state_charge_v2_state_sentence_association",
    "us_nd_state.state_drug_screen",
    "us_nd_state.state_early_discharge",
    "us_nd_state.state_employment_period",
    "us_nd_state.state_incarceration_incident",
    "us_nd_state.state_incarceration_incident_outcome",
    "us_nd_state.state_incarceration_period",
    "us_nd_state.state_incarceration_sentence",
    "us_nd_state.state_person",
    "us_nd_state.state_person_address_period",
    "us_nd_state.state_person_alias",
    "us_nd_state.state_person_ethnicity",
    "us_nd_state.state_person_external_id",
    "us_nd_state.state_person_housing_status_period",
    "us_nd_state.state_person_race",
    "us_nd_state.state_program_assignment",
    "us_nd_state.state_sentence",
    "us_nd_state.state_sentence_group",
    "us_nd_state.state_sentence_group_length",
    "us_nd_state.state_sentence_length",
    "us_nd_state.state_sentence_status_snapshot",
    "us_nd_state.state_staff",
    "us_nd_state.state_staff_caseload_type_period",
    "us_nd_state.state_staff_external_id",
    "us_nd_state.state_staff_location_period",
    "us_nd_state.state_staff_role_period",
    "us_nd_state.state_staff_supervisor_period",
    "us_nd_state.state_supervision_case_type_entry",
    "us_nd_state.state_supervision_contact",
    "us_nd_state.state_supervision_period",
    "us_nd_state.state_supervision_sentence",
    "us_nd_state.state_supervision_violated_condition_entry",
    "us_nd_state.state_supervision_violation",
    "us_nd_state.state_supervision_violation_response",
    "us_nd_state.state_supervision_violation_response_decision_entry",
    "us_nd_state.state_supervision_violation_type_entry",
    "us_nd_state.state_task_deadline",
    "us_ne_normalized_state.state_assessment",
    "us_ne_normalized_state.state_charge",
    "us_ne_normalized_state.state_charge_incarceration_sentence_association",
    "us_ne_normalized_state.state_charge_supervision_sentence_association",
    "us_ne_normalized_state.state_charge_v2",
    "us_ne_normalized_state.state_charge_v2_state_sentence_association",
    "us_ne_normalized_state.state_drug_screen",
    "us_ne_normalized_state.state_early_discharge",
    "us_ne_normalized_state.state_employment_period",
    "us_ne_normalized_state.state_incarceration_incident",
    "us_ne_normalized_state.state_incarceration_incident_outcome",
    "us_ne_normalized_state.state_incarceration_period",
    "us_ne_normalized_state.state_incarceration_sentence",
    "us_ne_normalized_state.state_person",
    "us_ne_normalized_state.state_person_address_period",
    "us_ne_normalized_state.state_person_alias",
    "us_ne_normalized_state.state_person_ethnicity",
    "us_ne_normalized_state.state_person_external_id",
    "us_ne_normalized_state.state_person_housing_status_period",
    "us_ne_normalized_state.state_person_race",
    "us_ne_normalized_state.state_program_assignment",
    "us_ne_normalized_state.state_sentence",
    "us_ne_normalized_state.state_sentence_group",
    "us_ne_normalized_state.state_sentence_group_length",
    "us_ne_normalized_state.state_sentence_inferred_group",
    "us_ne_normalized_state.state_sentence_length",
    "us_ne_normalized_state.state_sentence_status_snapshot",
    "us_ne_normalized_state.state_staff",
    "us_ne_normalized_state.state_staff_caseload_type_period",
    "us_ne_normalized_state.state_staff_external_id",
    "us_ne_normalized_state.state_staff_location_period",
    "us_ne_normalized_state.state_staff_role_period",
    "us_ne_normalized_state.state_staff_supervisor_period",
    "us_ne_normalized_state.state_supervision_case_type_entry",
    "us_ne_normalized_state.state_supervision_contact",
    "us_ne_normalized_state.state_supervision_period",
    "us_ne_normalized_state.state_supervision_sentence",
    "us_ne_normalized_state.state_supervision_violated_condition_entry",
    "us_ne_normalized_state.state_supervision_violation",
    "us_ne_normalized_state.state_supervision_violation_response",
    "us_ne_normalized_state.state_supervision_violation_response_decision_entry",
    "us_ne_normalized_state.state_supervision_violation_type_entry",
    "us_ne_normalized_state.state_task_deadline",
    "us_ne_state.state_assessment",
    "us_ne_state.state_charge",
    "us_ne_state.state_charge_incarceration_sentence_association",
    "us_ne_state.state_charge_supervision_sentence_association",
    "us_ne_state.state_charge_v2",
    "us_ne_state.state_charge_v2_state_sentence_association",
    "us_ne_state.state_drug_screen",
    "us_ne_state.state_early_discharge",
    "us_ne_state.state_employment_period",
    "us_ne_state.state_incarceration_incident",
    "us_ne_state.state_incarceration_incident_outcome",
    "us_ne_state.state_incarceration_period",
    "us_ne_state.state_incarceration_sentence",
    "us_ne_state.state_person",
    "us_ne_state.state_person_address_period",
    "us_ne_state.state_person_alias",
    "us_ne_state.state_person_ethnicity",
    "us_ne_state.state_person_external_id",
    "us_ne_state.state_person_housing_status_period",
    "us_ne_state.state_person_race",
    "us_ne_state.state_program_assignment",
    "us_ne_state.state_sentence",
    "us_ne_state.state_sentence_group",
    "us_ne_state.state_sentence_group_length",
    "us_ne_state.state_sentence_length",
    "us_ne_state.state_sentence_status_snapshot",
    "us_ne_state.state_staff",
    "us_ne_state.state_staff_caseload_type_period",
    "us_ne_state.state_staff_external_id",
    "us_ne_state.state_staff_location_period",
    "us_ne_state.state_staff_role_period",
    "us_ne_state.state_staff_supervisor_period",
    "us_ne_state.state_supervision_case_type_entry",
    "us_ne_state.state_supervision_contact",
    "us_ne_state.state_supervision_period",
    "us_ne_state.state_supervision_sentence",
    "us_ne_state.state_supervision_violated_condition_entry",
    "us_ne_state.state_supervision_violation",
    "us_ne_state.state_supervision_violation_response",
    "us_ne_state.state_supervision_violation_response_decision_entry",
    "us_ne_state.state_supervision_violation_type_entry",
    "us_ne_state.state_task_deadline",
    "us_or_normalized_state.state_assessment",
    "us_or_normalized_state.state_charge",
    "us_or_normalized_state.state_charge_incarceration_sentence_association",
    "us_or_normalized_state.state_charge_supervision_sentence_association",
    "us_or_normalized_state.state_charge_v2",
    "us_or_normalized_state.state_charge_v2_state_sentence_association",
    "us_or_normalized_state.state_drug_screen",
    "us_or_normalized_state.state_early_discharge",
    "us_or_normalized_state.state_employment_period",
    "us_or_normalized_state.state_incarceration_incident",
    "us_or_normalized_state.state_incarceration_incident_outcome",
    "us_or_normalized_state.state_incarceration_period",
    "us_or_normalized_state.state_incarceration_sentence",
    "us_or_normalized_state.state_person",
    "us_or_normalized_state.state_person_address_period",
    "us_or_normalized_state.state_person_alias",
    "us_or_normalized_state.state_person_ethnicity",
    "us_or_normalized_state.state_person_external_id",
    "us_or_normalized_state.state_person_housing_status_period",
    "us_or_normalized_state.state_person_race",
    "us_or_normalized_state.state_program_assignment",
    "us_or_normalized_state.state_sentence",
    "us_or_normalized_state.state_sentence_group",
    "us_or_normalized_state.state_sentence_group_length",
    "us_or_normalized_state.state_sentence_inferred_group",
    "us_or_normalized_state.state_sentence_length",
    "us_or_normalized_state.state_sentence_status_snapshot",
    "us_or_normalized_state.state_staff",
    "us_or_normalized_state.state_staff_caseload_type_period",
    "us_or_normalized_state.state_staff_external_id",
    "us_or_normalized_state.state_staff_location_period",
    "us_or_normalized_state.state_staff_role_period",
    "us_or_normalized_state.state_staff_supervisor_period",
    "us_or_normalized_state.state_supervision_case_type_entry",
    "us_or_normalized_state.state_supervision_contact",
    "us_or_normalized_state.state_supervision_period",
    "us_or_normalized_state.state_supervision_sentence",
    "us_or_normalized_state.state_supervision_violated_condition_entry",
    "us_or_normalized_state.state_supervision_violation",
    "us_or_normalized_state.state_supervision_violation_response",
    "us_or_normalized_state.state_supervision_violation_response_decision_entry",
    "us_or_normalized_state.state_supervision_violation_type_entry",
    "us_or_normalized_state.state_task_deadline",
    "us_or_state.state_assessment",
    "us_or_state.state_charge",
    "us_or_state.state_charge_incarceration_sentence_association",
    "us_or_state.state_charge_supervision_sentence_association",
    "us_or_state.state_charge_v2",
    "us_or_state.state_charge_v2_state_sentence_association",
    "us_or_state.state_drug_screen",
    "us_or_state.state_early_discharge",
    "us_or_state.state_employment_period",
    "us_or_state.state_incarceration_incident",
    "us_or_state.state_incarceration_incident_outcome",
    "us_or_state.state_incarceration_period",
    "us_or_state.state_incarceration_sentence",
    "us_or_state.state_person",
    "us_or_state.state_person_address_period",
    "us_or_state.state_person_alias",
    "us_or_state.state_person_ethnicity",
    "us_or_state.state_person_external_id",
    "us_or_state.state_person_housing_status_period",
    "us_or_state.state_person_race",
    "us_or_state.state_program_assignment",
    "us_or_state.state_sentence",
    "us_or_state.state_sentence_group",
    "us_or_state.state_sentence_group_length",
    "us_or_state.state_sentence_length",
    "us_or_state.state_sentence_status_snapshot",
    "us_or_state.state_staff",
    "us_or_state.state_staff_caseload_type_period",
    "us_or_state.state_staff_external_id",
    "us_or_state.state_staff_location_period",
    "us_or_state.state_staff_role_period",
    "us_or_state.state_staff_supervisor_period",
    "us_or_state.state_supervision_case_type_entry",
    "us_or_state.state_supervision_contact",
    "us_or_state.state_supervision_period",
    "us_or_state.state_supervision_sentence",
    "us_or_state.state_supervision_violated_condition_entry",
    "us_or_state.state_supervision_violation",
    "us_or_state.state_supervision_violation_response",
    "us_or_state.state_supervision_violation_response_decision_entry",
    "us_or_state.state_supervision_violation_type_entry",
    "us_or_state.state_task_deadline",
    "us_oz_normalized_state.state_assessment",
    "us_oz_normalized_state.state_charge",
    "us_oz_normalized_state.state_charge_incarceration_sentence_association",
    "us_oz_normalized_state.state_charge_supervision_sentence_association",
    "us_oz_normalized_state.state_charge_v2",
    "us_oz_normalized_state.state_charge_v2_state_sentence_association",
    "us_oz_normalized_state.state_drug_screen",
    "us_oz_normalized_state.state_early_discharge",
    "us_oz_normalized_state.state_employment_period",
    "us_oz_normalized_state.state_incarceration_incident",
    "us_oz_normalized_state.state_incarceration_incident_outcome",
    "us_oz_normalized_state.state_incarceration_period",
    "us_oz_normalized_state.state_incarceration_sentence",
    "us_oz_normalized_state.state_person",
    "us_oz_normalized_state.state_person_address_period",
    "us_oz_normalized_state.state_person_alias",
    "us_oz_normalized_state.state_person_ethnicity",
    "us_oz_normalized_state.state_person_external_id",
    "us_oz_normalized_state.state_person_housing_status_period",
    "us_oz_normalized_state.state_person_race",
    "us_oz_normalized_state.state_program_assignment",
    "us_oz_normalized_state.state_sentence",
    "us_oz_normalized_state.state_sentence_group",
    "us_oz_normalized_state.state_sentence_group_length",
    "us_oz_normalized_state.state_sentence_inferred_group",
    "us_oz_normalized_state.state_sentence_length",
    "us_oz_normalized_state.state_sentence_status_snapshot",
    "us_oz_normalized_state.state_staff",
    "us_oz_normalized_state.state_staff_caseload_type_period",
    "us_oz_normalized_state.state_staff_external_id",
    "us_oz_normalized_state.state_staff_location_period",
    "us_oz_normalized_state.state_staff_role_period",
    "us_oz_normalized_state.state_staff_supervisor_period",
    "us_oz_normalized_state.state_supervision_case_type_entry",
    "us_oz_normalized_state.state_supervision_contact",
    "us_oz_normalized_state.state_supervision_period",
    "us_oz_normalized_state.state_supervision_sentence",
    "us_oz_normalized_state.state_supervision_violated_condition_entry",
    "us_oz_normalized_state.state_supervision_violation",
    "us_oz_normalized_state.state_supervision_violation_response",
    "us_oz_normalized_state.state_supervision_violation_response_decision_entry",
    "us_oz_normalized_state.state_supervision_violation_type_entry",
    "us_oz_normalized_state.state_task_deadline",
    "us_oz_state.state_assessment",
    "us_oz_state.state_charge",
    "us_oz_state.state_charge_incarceration_sentence_association",
    "us_oz_state.state_charge_supervision_sentence_association",
    "us_oz_state.state_charge_v2",
    "us_oz_state.state_charge_v2_state_sentence_association",
    "us_oz_state.state_drug_screen",
    "us_oz_state.state_early_discharge",
    "us_oz_state.state_employment_period",
    "us_oz_state.state_incarceration_incident",
    "us_oz_state.state_incarceration_incident_outcome",
    "us_oz_state.state_incarceration_period",
    "us_oz_state.state_incarceration_sentence",
    "us_oz_state.state_person",
    "us_oz_state.state_person_address_period",
    "us_oz_state.state_person_alias",
    "us_oz_state.state_person_ethnicity",
    "us_oz_state.state_person_external_id",
    "us_oz_state.state_person_housing_status_period",
    "us_oz_state.state_person_race",
    "us_oz_state.state_program_assignment",
    "us_oz_state.state_sentence",
    "us_oz_state.state_sentence_group",
    "us_oz_state.state_sentence_group_length",
    "us_oz_state.state_sentence_length",
    "us_oz_state.state_sentence_status_snapshot",
    "us_oz_state.state_staff",
    "us_oz_state.state_staff_caseload_type_period",
    "us_oz_state.state_staff_external_id",
    "us_oz_state.state_staff_location_period",
    "us_oz_state.state_staff_role_period",
    "us_oz_state.state_staff_supervisor_period",
    "us_oz_state.state_supervision_case_type_entry",
    "us_oz_state.state_supervision_contact",
    "us_oz_state.state_supervision_period",
    "us_oz_state.state_supervision_sentence",
    "us_oz_state.state_supervision_violated_condition_entry",
    "us_oz_state.state_supervision_violation",
    "us_oz_state.state_supervision_violation_response",
    "us_oz_state.state_supervision_violation_response_decision_entry",
    "us_oz_state.state_supervision_violation_type_entry",
    "us_oz_state.state_task_deadline",
    "us_pa_normalized_state.state_assessment",
    "us_pa_normalized_state.state_charge",
    "us_pa_normalized_state.state_charge_incarceration_sentence_association",
    "us_pa_normalized_state.state_charge_supervision_sentence_association",
    "us_pa_normalized_state.state_charge_v2",
    "us_pa_normalized_state.state_charge_v2_state_sentence_association",
    "us_pa_normalized_state.state_drug_screen",
    "us_pa_normalized_state.state_early_discharge",
    "us_pa_normalized_state.state_employment_period",
    "us_pa_normalized_state.state_incarceration_incident",
    "us_pa_normalized_state.state_incarceration_incident_outcome",
    "us_pa_normalized_state.state_incarceration_period",
    "us_pa_normalized_state.state_incarceration_sentence",
    "us_pa_normalized_state.state_person",
    "us_pa_normalized_state.state_person_address_period",
    "us_pa_normalized_state.state_person_alias",
    "us_pa_normalized_state.state_person_ethnicity",
    "us_pa_normalized_state.state_person_external_id",
    "us_pa_normalized_state.state_person_housing_status_period",
    "us_pa_normalized_state.state_person_race",
    "us_pa_normalized_state.state_program_assignment",
    "us_pa_normalized_state.state_sentence",
    "us_pa_normalized_state.state_sentence_group",
    "us_pa_normalized_state.state_sentence_group_length",
    "us_pa_normalized_state.state_sentence_inferred_group",
    "us_pa_normalized_state.state_sentence_length",
    "us_pa_normalized_state.state_sentence_status_snapshot",
    "us_pa_normalized_state.state_staff",
    "us_pa_normalized_state.state_staff_caseload_type_period",
    "us_pa_normalized_state.state_staff_external_id",
    "us_pa_normalized_state.state_staff_location_period",
    "us_pa_normalized_state.state_staff_role_period",
    "us_pa_normalized_state.state_staff_supervisor_period",
    "us_pa_normalized_state.state_supervision_case_type_entry",
    "us_pa_normalized_state.state_supervision_contact",
    "us_pa_normalized_state.state_supervision_period",
    "us_pa_normalized_state.state_supervision_sentence",
    "us_pa_normalized_state.state_supervision_violated_condition_entry",
    "us_pa_normalized_state.state_supervision_violation",
    "us_pa_normalized_state.state_supervision_violation_response",
    "us_pa_normalized_state.state_supervision_violation_response_decision_entry",
    "us_pa_normalized_state.state_supervision_violation_type_entry",
    "us_pa_normalized_state.state_task_deadline",
    "us_pa_state.state_assessment",
    "us_pa_state.state_charge",
    "us_pa_state.state_charge_incarceration_sentence_association",
    "us_pa_state.state_charge_supervision_sentence_association",
    "us_pa_state.state_charge_v2",
    "us_pa_state.state_charge_v2_state_sentence_association",
    "us_pa_state.state_drug_screen",
    "us_pa_state.state_early_discharge",
    "us_pa_state.state_employment_period",
    "us_pa_state.state_incarceration_incident",
    "us_pa_state.state_incarceration_incident_outcome",
    "us_pa_state.state_incarceration_period",
    "us_pa_state.state_incarceration_sentence",
    "us_pa_state.state_person",
    "us_pa_state.state_person_address_period",
    "us_pa_state.state_person_alias",
    "us_pa_state.state_person_ethnicity",
    "us_pa_state.state_person_external_id",
    "us_pa_state.state_person_housing_status_period",
    "us_pa_state.state_person_race",
    "us_pa_state.state_program_assignment",
    "us_pa_state.state_sentence",
    "us_pa_state.state_sentence_group",
    "us_pa_state.state_sentence_group_length",
    "us_pa_state.state_sentence_length",
    "us_pa_state.state_sentence_status_snapshot",
    "us_pa_state.state_staff",
    "us_pa_state.state_staff_caseload_type_period",
    "us_pa_state.state_staff_external_id",
    "us_pa_state.state_staff_location_period",
    "us_pa_state.state_staff_role_period",
    "us_pa_state.state_staff_supervisor_period",
    "us_pa_state.state_supervision_case_type_entry",
    "us_pa_state.state_supervision_contact",
    "us_pa_state.state_supervision_period",
    "us_pa_state.state_supervision_sentence",
    "us_pa_state.state_supervision_violated_condition_entry",
    "us_pa_state.state_supervision_violation",
    "us_pa_state.state_supervision_violation_response",
    "us_pa_state.state_supervision_violation_response_decision_entry",
    "us_pa_state.state_supervision_violation_type_entry",
    "us_pa_state.state_task_deadline",
    "us_tn_normalized_state.state_assessment",
    "us_tn_normalized_state.state_charge",
    "us_tn_normalized_state.state_charge_incarceration_sentence_association",
    "us_tn_normalized_state.state_charge_supervision_sentence_association",
    "us_tn_normalized_state.state_charge_v2",
    "us_tn_normalized_state.state_charge_v2_state_sentence_association",
    "us_tn_normalized_state.state_drug_screen",
    "us_tn_normalized_state.state_early_discharge",
    "us_tn_normalized_state.state_employment_period",
    "us_tn_normalized_state.state_incarceration_incident",
    "us_tn_normalized_state.state_incarceration_incident_outcome",
    "us_tn_normalized_state.state_incarceration_period",
    "us_tn_normalized_state.state_incarceration_sentence",
    "us_tn_normalized_state.state_person",
    "us_tn_normalized_state.state_person_address_period",
    "us_tn_normalized_state.state_person_alias",
    "us_tn_normalized_state.state_person_ethnicity",
    "us_tn_normalized_state.state_person_external_id",
    "us_tn_normalized_state.state_person_housing_status_period",
    "us_tn_normalized_state.state_person_race",
    "us_tn_normalized_state.state_program_assignment",
    "us_tn_normalized_state.state_sentence",
    "us_tn_normalized_state.state_sentence_group",
    "us_tn_normalized_state.state_sentence_group_length",
    "us_tn_normalized_state.state_sentence_inferred_group",
    "us_tn_normalized_state.state_sentence_length",
    "us_tn_normalized_state.state_sentence_status_snapshot",
    "us_tn_normalized_state.state_staff",
    "us_tn_normalized_state.state_staff_caseload_type_period",
    "us_tn_normalized_state.state_staff_external_id",
    "us_tn_normalized_state.state_staff_location_period",
    "us_tn_normalized_state.state_staff_role_period",
    "us_tn_normalized_state.state_staff_supervisor_period",
    "us_tn_normalized_state.state_supervision_case_type_entry",
    "us_tn_normalized_state.state_supervision_contact",
    "us_tn_normalized_state.state_supervision_period",
    "us_tn_normalized_state.state_supervision_sentence",
    "us_tn_normalized_state.state_supervision_violated_condition_entry",
    "us_tn_normalized_state.state_supervision_violation",
    "us_tn_normalized_state.state_supervision_violation_response",
    "us_tn_normalized_state.state_supervision_violation_response_decision_entry",
    "us_tn_normalized_state.state_supervision_violation_type_entry",
    "us_tn_normalized_state.state_task_deadline",
    "us_tn_state.state_assessment",
    "us_tn_state.state_charge",
    "us_tn_state.state_charge_incarceration_sentence_association",
    "us_tn_state.state_charge_supervision_sentence_association",
    "us_tn_state.state_charge_v2",
    "us_tn_state.state_charge_v2_state_sentence_association",
    "us_tn_state.state_drug_screen",
    "us_tn_state.state_early_discharge",
    "us_tn_state.state_employment_period",
    "us_tn_state.state_incarceration_incident",
    "us_tn_state.state_incarceration_incident_outcome",
    "us_tn_state.state_incarceration_period",
    "us_tn_state.state_incarceration_sentence",
    "us_tn_state.state_person",
    "us_tn_state.state_person_address_period",
    "us_tn_state.state_person_alias",
    "us_tn_state.state_person_ethnicity",
    "us_tn_state.state_person_external_id",
    "us_tn_state.state_person_housing_status_period",
    "us_tn_state.state_person_race",
    "us_tn_state.state_program_assignment",
    "us_tn_state.state_sentence",
    "us_tn_state.state_sentence_group",
    "us_tn_state.state_sentence_group_length",
    "us_tn_state.state_sentence_length",
    "us_tn_state.state_sentence_status_snapshot",
    "us_tn_state.state_staff",
    "us_tn_state.state_staff_caseload_type_period",
    "us_tn_state.state_staff_external_id",
    "us_tn_state.state_staff_location_period",
    "us_tn_state.state_staff_role_period",
    "us_tn_state.state_staff_supervisor_period",
    "us_tn_state.state_supervision_case_type_entry",
    "us_tn_state.state_supervision_contact",
    "us_tn_state.state_supervision_period",
    "us_tn_state.state_supervision_sentence",
    "us_tn_state.state_supervision_violated_condition_entry",
    "us_tn_state.state_supervision_violation",
    "us_tn_state.state_supervision_violation_response",
    "us_tn_state.state_supervision_violation_response_decision_entry",
    "us_tn_state.state_supervision_violation_type_entry",
    "us_tn_state.state_task_deadline",
    "us_tx_normalized_state.state_assessment",
    "us_tx_normalized_state.state_charge",
    "us_tx_normalized_state.state_charge_incarceration_sentence_association",
    "us_tx_normalized_state.state_charge_supervision_sentence_association",
    "us_tx_normalized_state.state_charge_v2",
    "us_tx_normalized_state.state_charge_v2_state_sentence_association",
    "us_tx_normalized_state.state_drug_screen",
    "us_tx_normalized_state.state_early_discharge",
    "us_tx_normalized_state.state_employment_period",
    "us_tx_normalized_state.state_incarceration_incident",
    "us_tx_normalized_state.state_incarceration_incident_outcome",
    "us_tx_normalized_state.state_incarceration_period",
    "us_tx_normalized_state.state_incarceration_sentence",
    "us_tx_normalized_state.state_person",
    "us_tx_normalized_state.state_person_address_period",
    "us_tx_normalized_state.state_person_alias",
    "us_tx_normalized_state.state_person_ethnicity",
    "us_tx_normalized_state.state_person_external_id",
    "us_tx_normalized_state.state_person_housing_status_period",
    "us_tx_normalized_state.state_person_race",
    "us_tx_normalized_state.state_program_assignment",
    "us_tx_normalized_state.state_sentence",
    "us_tx_normalized_state.state_sentence_group",
    "us_tx_normalized_state.state_sentence_group_length",
    "us_tx_normalized_state.state_sentence_inferred_group",
    "us_tx_normalized_state.state_sentence_length",
    "us_tx_normalized_state.state_sentence_status_snapshot",
    "us_tx_normalized_state.state_staff",
    "us_tx_normalized_state.state_staff_caseload_type_period",
    "us_tx_normalized_state.state_staff_external_id",
    "us_tx_normalized_state.state_staff_location_period",
    "us_tx_normalized_state.state_staff_role_period",
    "us_tx_normalized_state.state_staff_supervisor_period",
    "us_tx_normalized_state.state_supervision_case_type_entry",
    "us_tx_normalized_state.state_supervision_contact",
    "us_tx_normalized_state.state_supervision_period",
    "us_tx_normalized_state.state_supervision_sentence",
    "us_tx_normalized_state.state_supervision_violated_condition_entry",
    "us_tx_normalized_state.state_supervision_violation",
    "us_tx_normalized_state.state_supervision_violation_response",
    "us_tx_normalized_state.state_supervision_violation_response_decision_entry",
    "us_tx_normalized_state.state_supervision_violation_type_entry",
    "us_tx_normalized_state.state_task_deadline",
    "us_tx_state.state_assessment",
    "us_tx_state.state_charge",
    "us_tx_state.state_charge_incarceration_sentence_association",
    "us_tx_state.state_charge_supervision_sentence_association",
    "us_tx_state.state_charge_v2",
    "us_tx_state.state_charge_v2_state_sentence_association",
    "us_tx_state.state_drug_screen",
    "us_tx_state.state_early_discharge",
    "us_tx_state.state_employment_period",
    "us_tx_state.state_incarceration_incident",
    "us_tx_state.state_incarceration_incident_outcome",
    "us_tx_state.state_incarceration_period",
    "us_tx_state.state_incarceration_sentence",
    "us_tx_state.state_person",
    "us_tx_state.state_person_address_period",
    "us_tx_state.state_person_alias",
    "us_tx_state.state_person_ethnicity",
    "us_tx_state.state_person_external_id",
    "us_tx_state.state_person_housing_status_period",
    "us_tx_state.state_person_race",
    "us_tx_state.state_program_assignment",
    "us_tx_state.state_sentence",
    "us_tx_state.state_sentence_group",
    "us_tx_state.state_sentence_group_length",
    "us_tx_state.state_sentence_length",
    "us_tx_state.state_sentence_status_snapshot",
    "us_tx_state.state_staff",
    "us_tx_state.state_staff_caseload_type_period",
    "us_tx_state.state_staff_external_id",
    "us_tx_state.state_staff_location_period",
    "us_tx_state.state_staff_role_period",
    "us_tx_state.state_staff_supervisor_period",
    "us_tx_state.state_supervision_case_type_entry",
    "us_tx_state.state_supervision_contact",
    "us_tx_state.state_supervision_period",
    "us_tx_state.state_supervision_sentence",
    "us_tx_state.state_supervision_violated_condition_entry",
    "us_tx_state.state_supervision_violation",
    "us_tx_state.state_supervision_violation_response",
    "us_tx_state.state_supervision_violation_response_decision_entry",
    "us_tx_state.state_supervision_violation_type_entry",
    "us_tx_state.state_task_deadline",
    "us_ut_normalized_state.state_assessment",
    "us_ut_normalized_state.state_charge",
    "us_ut_normalized_state.state_charge_incarceration_sentence_association",
    "us_ut_normalized_state.state_charge_supervision_sentence_association",
    "us_ut_normalized_state.state_charge_v2",
    "us_ut_normalized_state.state_charge_v2_state_sentence_association",
    "us_ut_normalized_state.state_drug_screen",
    "us_ut_normalized_state.state_early_discharge",
    "us_ut_normalized_state.state_employment_period",
    "us_ut_normalized_state.state_incarceration_incident",
    "us_ut_normalized_state.state_incarceration_incident_outcome",
    "us_ut_normalized_state.state_incarceration_period",
    "us_ut_normalized_state.state_incarceration_sentence",
    "us_ut_normalized_state.state_person",
    "us_ut_normalized_state.state_person_address_period",
    "us_ut_normalized_state.state_person_alias",
    "us_ut_normalized_state.state_person_ethnicity",
    "us_ut_normalized_state.state_person_external_id",
    "us_ut_normalized_state.state_person_housing_status_period",
    "us_ut_normalized_state.state_person_race",
    "us_ut_normalized_state.state_program_assignment",
    "us_ut_normalized_state.state_sentence",
    "us_ut_normalized_state.state_sentence_group",
    "us_ut_normalized_state.state_sentence_group_length",
    "us_ut_normalized_state.state_sentence_inferred_group",
    "us_ut_normalized_state.state_sentence_length",
    "us_ut_normalized_state.state_sentence_status_snapshot",
    "us_ut_normalized_state.state_staff",
    "us_ut_normalized_state.state_staff_caseload_type_period",
    "us_ut_normalized_state.state_staff_external_id",
    "us_ut_normalized_state.state_staff_location_period",
    "us_ut_normalized_state.state_staff_role_period",
    "us_ut_normalized_state.state_staff_supervisor_period",
    "us_ut_normalized_state.state_supervision_case_type_entry",
    "us_ut_normalized_state.state_supervision_contact",
    "us_ut_normalized_state.state_supervision_period",
    "us_ut_normalized_state.state_supervision_sentence",
    "us_ut_normalized_state.state_supervision_violated_condition_entry",
    "us_ut_normalized_state.state_supervision_violation",
    "us_ut_normalized_state.state_supervision_violation_response",
    "us_ut_normalized_state.state_supervision_violation_response_decision_entry",
    "us_ut_normalized_state.state_supervision_violation_type_entry",
    "us_ut_normalized_state.state_task_deadline",
    "us_ut_state.state_assessment",
    "us_ut_state.state_charge",
    "us_ut_state.state_charge_incarceration_sentence_association",
    "us_ut_state.state_charge_supervision_sentence_association",
    "us_ut_state.state_charge_v2",
    "us_ut_state.state_charge_v2_state_sentence_association",
    "us_ut_state.state_drug_screen",
    "us_ut_state.state_early_discharge",
    "us_ut_state.state_employment_period",
    "us_ut_state.state_incarceration_incident",
    "us_ut_state.state_incarceration_incident_outcome",
    "us_ut_state.state_incarceration_period",
    "us_ut_state.state_incarceration_sentence",
    "us_ut_state.state_person",
    "us_ut_state.state_person_address_period",
    "us_ut_state.state_person_alias",
    "us_ut_state.state_person_ethnicity",
    "us_ut_state.state_person_external_id",
    "us_ut_state.state_person_housing_status_period",
    "us_ut_state.state_person_race",
    "us_ut_state.state_program_assignment",
    "us_ut_state.state_sentence",
    "us_ut_state.state_sentence_group",
    "us_ut_state.state_sentence_group_length",
    "us_ut_state.state_sentence_length",
    "us_ut_state.state_sentence_status_snapshot",
    "us_ut_state.state_staff",
    "us_ut_state.state_staff_caseload_type_period",
    "us_ut_state.state_staff_external_id",
    "us_ut_state.state_staff_location_period",
    "us_ut_state.state_staff_role_period",
    "us_ut_state.state_staff_supervisor_period",
    "us_ut_state.state_supervision_case_type_entry",
    "us_ut_state.state_supervision_contact",
    "us_ut_state.state_supervision_period",
    "us_ut_state.state_supervision_sentence",
    "us_ut_state.state_supervision_violated_condition_entry",
    "us_ut_state.state_supervision_violation",
    "us_ut_state.state_supervision_violation_response",
    "us_ut_state.state_supervision_violation_response_decision_entry",
    "us_ut_state.state_supervision_violation_type_entry",
    "us_ut_state.state_task_deadline",
]


def build_bq_snapshot(bq_client: BigQueryClient) -> list[str]:
    """Builds a snapshot of dataset names and their table names to assert against"""
    return [
        f"{dataset.dataset_id}.{table.table_id}"
        for dataset in bq_client.list_datasets()
        for table in bq_client.list_tables(dataset_id=dataset.dataset_id)
        # TODO(#30495): Once we are able to stop loading raw source tables below, we can
        #  delete this filter.
        if "raw_data" not in dataset.dataset_id
    ]


@pytest.mark.uses_bq_emulator
class UpdateBigQueryTableSchemasTest(BigQueryEmulatorTestCase):
    """Tests basic functionality of the update_big_query_table_schemas tool"""

    # Deleting our data is actually quite slow. Since this class only has one test case, we can skip it to save time
    wipe_emulator_data_on_teardown = False

    @classmethod
    def get_source_tables(cls) -> list[SourceTableCollection]:
        """Uses the set of raw data tables as input so ingest views can compile"""
        # TODO(#30495): Once we generate ingest view schemas based on types defined in
        #  the ingest mappings YAMLs, we won't need to load the raw data tables in order
        #  to build the ingest view output tables.
        return []

    def test_create_dataflow_output_source_tables_matches_expected(self) -> None:
        """Tests that the source tables output by the source table update for Dataflow
        output tables include all expected tables.
        """
        source_table_repository = SourceTableRepository(
            source_table_collections=get_dataflow_output_source_table_collections()
        )
        update_all_source_table_schemas(
            source_table_collections=collect_managed_source_table_collections(
                source_table_repository
            ),
            update_manager=SourceTableUpdateManager(client=self.bq_client),
            dry_run=False,
            log_output=True,
        )

        found_bq_tables = build_bq_snapshot(bq_client=self.bq_client)

        self.assertEqual(
            len(EXPECTED_DATAFLOW_OUTPUT_TABLES),
            len(set(EXPECTED_DATAFLOW_OUTPUT_TABLES)),
            "Found duplicate values in EXPECTED_DATAFLOW_OUTPUT_TABLES",
        )

        self.assertEqual(
            set(found_bq_tables),
            set(EXPECTED_DATAFLOW_OUTPUT_TABLES),
            "The list of expected output tables for all of our Dataflow pipelines "
            "has changed. If this test fails due to a newly added / deleted table "
            "(e.g. a newly added ingest view), update the the "
            "EXPECTED_DATAFLOW_OUTPUT_TABLES list accordingly.",
        )

        self.assertEqual(
            EXPECTED_DATAFLOW_OUTPUT_TABLES,
            sorted(EXPECTED_DATAFLOW_OUTPUT_TABLES),
            "EXPECTED_DATAFLOW_OUTPUT_TABLES should be alphabetically sorted",
        )

    def test_no_overlapping_addresses(self) -> None:
        source_table_repository = build_source_table_repository_for_collected_schemata(
            project_id=None
        )
        source_table_collections = collect_managed_source_table_collections(
            source_table_repository=source_table_repository,
        )
        visited_addresses = set()
        duplicate_addresses = set()

        for source_table_collection in source_table_collections:
            for source_table_config in source_table_collection.source_tables:
                address = source_table_config.address
                if address in visited_addresses:
                    duplicate_addresses.add(address.to_str())
                visited_addresses.add(address)

        if duplicate_addresses:
            raise ValueError(
                f"Expected no duplicate addresses across source table collections; found: {duplicate_addresses}"
            )
