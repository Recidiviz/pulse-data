# pylint: skip-file
"""dedup_nd_sids_2

Revision ID: c84adc99e1d7
Revises: 5b5d6d1f42a0
Create Date: 2023-07-24 10:06:23.016465

"""
from typing import List, Tuple

from alembic import op

from recidiviz.utils.string import StrictStringFormatter

# revision identifiers, used by Alembic.
revision = "c84adc99e1d7"
down_revision = "5b5d6d1f42a0"
branch_labels = None
depends_on = None

_ID_VALUE_MAP: List[Tuple[str, str]] = [
    ("'198437'", "'US_ND_SID'"),
    ("'223210'", "'US_ND_SID'"),
    ("'253369'", "'US_ND_SID'"),
    ("'232380'", "'US_ND_SID'"),
]

UPGRADE_QUERY_TEMPLATE = """
    DELETE FROM state_person_external_id
    WHERE id_type = {id_type}
    AND external_id = {bad_value}
"""


def upgrade() -> None:
    # ### commands auto generated by Alembic - please adjust! ###
    for bad_value, id_type in _ID_VALUE_MAP:
        op.execute(
            StrictStringFormatter().format(
                UPGRADE_QUERY_TEMPLATE,
                bad_value=bad_value,
                id_type=id_type,
            )
        )
    # ### end Alembic commands ###


def downgrade() -> None:
    # ### commands auto generated by Alembic - please adjust! ###
    pass
    # ### end Alembic commands ###
