# pylint: skip-file
"""add_early_discharge_entities

Revision ID: fbb8c36dd4b9
Revises: de5e9f994f17
Create Date: 2020-04-20 15:32:16.954534

"""
from alembic import op
import sqlalchemy as sa


# revision identifiers, used by Alembic.
revision = 'fbb8c36dd4b9'
down_revision = 'de5e9f994f17'
branch_labels = None
depends_on = None


def upgrade():
    # ### commands auto generated by Alembic - please adjust! ###
    op.create_table('state_early_discharge',
    sa.Column('external_id', sa.String(length=255), nullable=True),
    sa.Column('state_code', sa.String(length=255), nullable=False),
    sa.Column('county_code', sa.String(length=255), nullable=True),
    sa.Column('decision_date', sa.Date(), nullable=True),
    sa.Column('decision', sa.Enum('REQUEST_DENIED', 'SENTENCE_TERMINATION_GRANTED', 'UNSUPERVISED_PROBATION_GRANTED', name='state_early_discharge_decision'), nullable=True),
    sa.Column('decision_raw_text', sa.String(length=255), nullable=True),
    sa.Column('deciding_body_type', sa.Enum('COURT', 'PAROLE_BOARD', 'SENTENCED_PERSON', 'SUPERVISION_OFFICER', name='state_acting_body_type'), nullable=True),
    sa.Column('deciding_body_type_raw_text', sa.String(length=255), nullable=True),
    sa.Column('request_date', sa.Date(), nullable=True),
    sa.Column('requesting_body_type', sa.Enum('COURT', 'PAROLE_BOARD', 'SENTENCED_PERSON', 'SUPERVISION_OFFICER', name='state_acting_body_type'), nullable=True),
    sa.Column('requesting_body_type_raw_text', sa.String(length=255), nullable=True),
    sa.Column('early_discharge_id', sa.Integer(), nullable=False),
    sa.Column('supervision_sentence_id', sa.Integer(), nullable=True),
    sa.Column('incarceration_sentence_id', sa.Integer(), nullable=True),
    sa.Column('person_id', sa.Integer(), nullable=False),
    sa.ForeignKeyConstraint(['incarceration_sentence_id'], ['state_incarceration_sentence.incarceration_sentence_id'], initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['person_id'], ['state_person.person_id'], initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['supervision_sentence_id'], ['state_supervision_sentence.supervision_sentence_id'], initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('early_discharge_id')
    )
    op.create_index(op.f('ix_state_early_discharge_external_id'), 'state_early_discharge', ['external_id'], unique=False)
    op.create_index(op.f('ix_state_early_discharge_incarceration_sentence_id'), 'state_early_discharge', ['incarceration_sentence_id'], unique=False)
    op.create_index(op.f('ix_state_early_discharge_person_id'), 'state_early_discharge', ['person_id'], unique=False)
    op.create_index(op.f('ix_state_early_discharge_state_code'), 'state_early_discharge', ['state_code'], unique=False)
    op.create_index(op.f('ix_state_early_discharge_supervision_sentence_id'), 'state_early_discharge', ['supervision_sentence_id'], unique=False)
    op.create_table('state_early_discharge_history',
    sa.Column('valid_from', sa.DateTime(), nullable=False),
    sa.Column('valid_to', sa.DateTime(), nullable=True),
    sa.Column('external_id', sa.String(length=255), nullable=True),
    sa.Column('state_code', sa.String(length=255), nullable=False),
    sa.Column('county_code', sa.String(length=255), nullable=True),
    sa.Column('decision_date', sa.Date(), nullable=True),
    sa.Column('decision', sa.Enum('REQUEST_DENIED', 'SENTENCE_TERMINATION_GRANTED', 'UNSUPERVISED_PROBATION_GRANTED', name='state_early_discharge_decision'), nullable=True),
    sa.Column('decision_raw_text', sa.String(length=255), nullable=True),
    sa.Column('deciding_body_type', sa.Enum('COURT', 'PAROLE_BOARD', 'SENTENCED_PERSON', 'SUPERVISION_OFFICER', name='state_acting_body_type'), nullable=True),
    sa.Column('deciding_body_type_raw_text', sa.String(length=255), nullable=True),
    sa.Column('request_date', sa.Date(), nullable=True),
    sa.Column('requesting_body_type', sa.Enum('COURT', 'PAROLE_BOARD', 'SENTENCED_PERSON', 'SUPERVISION_OFFICER', name='state_acting_body_type'), nullable=True),
    sa.Column('requesting_body_type_raw_text', sa.String(length=255), nullable=True),
    sa.Column('early_discharge_history_id', sa.Integer(), nullable=False),
    sa.Column('early_discharge_id', sa.Integer(), nullable=False),
    sa.Column('supervision_sentence_id', sa.Integer(), nullable=True),
    sa.Column('incarceration_sentence_id', sa.Integer(), nullable=True),
    sa.Column('person_id', sa.Integer(), nullable=False),
    sa.ForeignKeyConstraint(['early_discharge_id'], ['state_early_discharge.early_discharge_id'], ),
    sa.ForeignKeyConstraint(['incarceration_sentence_id'], ['state_incarceration_sentence.incarceration_sentence_id'], initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['person_id'], ['state_person.person_id'], initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['supervision_sentence_id'], ['state_supervision_sentence.supervision_sentence_id'], initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('early_discharge_history_id')
    )
    op.create_index(op.f('ix_state_early_discharge_history_early_discharge_id'), 'state_early_discharge_history', ['early_discharge_id'], unique=False)
    op.create_index(op.f('ix_state_early_discharge_history_external_id'), 'state_early_discharge_history', ['external_id'], unique=False)
    op.create_index(op.f('ix_state_early_discharge_history_incarceration_sentence_id'), 'state_early_discharge_history', ['incarceration_sentence_id'], unique=False)
    op.create_index(op.f('ix_state_early_discharge_history_person_id'), 'state_early_discharge_history', ['person_id'], unique=False)
    op.create_index(op.f('ix_state_early_discharge_history_state_code'), 'state_early_discharge_history', ['state_code'], unique=False)
    op.create_index(op.f('ix_state_early_discharge_history_supervision_sentence_id'), 'state_early_discharge_history', ['supervision_sentence_id'], unique=False)
    # ### end Alembic commands ###


def downgrade():
    # ### commands auto generated by Alembic - please adjust! ###
    op.drop_index(op.f('ix_state_early_discharge_history_supervision_sentence_id'), table_name='state_early_discharge_history')
    op.drop_index(op.f('ix_state_early_discharge_history_state_code'), table_name='state_early_discharge_history')
    op.drop_index(op.f('ix_state_early_discharge_history_person_id'), table_name='state_early_discharge_history')
    op.drop_index(op.f('ix_state_early_discharge_history_incarceration_sentence_id'), table_name='state_early_discharge_history')
    op.drop_index(op.f('ix_state_early_discharge_history_external_id'), table_name='state_early_discharge_history')
    op.drop_index(op.f('ix_state_early_discharge_history_early_discharge_id'), table_name='state_early_discharge_history')
    op.drop_table('state_early_discharge_history')
    op.drop_index(op.f('ix_state_early_discharge_supervision_sentence_id'), table_name='state_early_discharge')
    op.drop_index(op.f('ix_state_early_discharge_state_code'), table_name='state_early_discharge')
    op.drop_index(op.f('ix_state_early_discharge_person_id'), table_name='state_early_discharge')
    op.drop_index(op.f('ix_state_early_discharge_incarceration_sentence_id'), table_name='state_early_discharge')
    op.drop_index(op.f('ix_state_early_discharge_external_id'), table_name='state_early_discharge')
    op.drop_table('state_early_discharge')

    op.execute('DROP TYPE state_acting_body_type;')
    op.execute('DROP TYPE state_early_discharge_decision;')
    # ### end Alembic commands ###
