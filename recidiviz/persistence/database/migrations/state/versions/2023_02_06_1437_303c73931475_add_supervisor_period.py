# pylint: skip-file
"""add_supervisor_period

Revision ID: 303c73931475
Revises: bb7693b02960
Create Date: 2023-02-06 14:37:37.137493

"""
import sqlalchemy as sa
from alembic import op

# revision identifiers, used by Alembic.
revision = "303c73931475"
down_revision = "bb7693b02960"
branch_labels = None
depends_on = None


def upgrade() -> None:
    # ### commands auto generated by Alembic - please adjust! ###
    op.create_table(
        "state_staff_supervisor_period",
        sa.Column(
            "staff_supervisor_period_id",
            sa.Integer(),
            nullable=False,
            comment="Unique identifier for a(n) staff member supervisor period, generated automatically by the Recidiviz system. This identifier is not stable over time (it may change if historical data is re-ingested), but should be used within the context of a given dataset to connect this object to others.",
        ),
        sa.Column(
            "external_id",
            sa.String(length=255),
            nullable=False,
            comment="The unique identifier for the StateStaffSupervisorPeriod, unique within the scope of the source data system.",
        ),
        sa.Column(
            "state_code",
            sa.String(length=255),
            nullable=False,
            comment="The U.S. state or region that provided the source data.",
        ),
        sa.Column(
            "start_date",
            sa.Date(),
            nullable=False,
            comment="The date on which the staff member started serving this role.",
        ),
        sa.Column(
            "end_date",
            sa.Date(),
            nullable=True,
            comment="The date on which the staff member stopped serving this role. This is an exclusive end date, meaning this staff member is no longer considered to have this role on this day.",
        ),
        sa.Column(
            "supervisor_staff_external_id",
            sa.String(length=255),
            nullable=False,
            comment="The external id of this staff member's supervisor.",
        ),
        sa.Column(
            "supervisor_staff_external_id_type",
            sa.String(length=255),
            nullable=False,
            comment="The id type associated with the supervisor_staff_external_id field.",
        ),
        sa.Column(
            "staff_id",
            sa.Integer(),
            nullable=False,
            comment="Unique identifier for a(n) staff member, generated automatically by the Recidiviz system. This identifier is not stable over time (it may change if historical data is re-ingested), but should be used within the context of a given dataset to connect this object to relevant staff member information.",
        ),
        sa.ForeignKeyConstraint(
            ["staff_id"],
            ["state_staff.staff_id"],
            initially="DEFERRED",
            deferrable=True,
        ),
        sa.PrimaryKeyConstraint("staff_supervisor_period_id"),
        sa.UniqueConstraint(
            "state_code",
            "external_id",
            deferrable="True",
            initially="DEFERRED",
            name="staff_supervisor_periods_unique_within_region",
        ),
        comment="The StateStaffSupervisorPeriod object represents information about a staff memberâ€™s direct supervisor during a particular period of time. ",
    )
    op.create_index(
        op.f("ix_state_staff_supervisor_period_external_id"),
        "state_staff_supervisor_period",
        ["external_id"],
        unique=False,
    )
    op.create_index(
        op.f("ix_state_staff_supervisor_period_staff_id"),
        "state_staff_supervisor_period",
        ["staff_id"],
        unique=False,
    )
    op.create_index(
        op.f("ix_state_staff_supervisor_period_state_code"),
        "state_staff_supervisor_period",
        ["state_code"],
        unique=False,
    )
    # ### end Alembic commands ###


def downgrade() -> None:
    # ### commands auto generated by Alembic - please adjust! ###
    op.drop_index(
        op.f("ix_state_staff_supervisor_period_state_code"),
        table_name="state_staff_supervisor_period",
    )
    op.drop_index(
        op.f("ix_state_staff_supervisor_period_staff_id"),
        table_name="state_staff_supervisor_period",
    )
    op.drop_index(
        op.f("ix_state_staff_supervisor_period_external_id"),
        table_name="state_staff_supervisor_period",
    )
    op.drop_table("state_staff_supervisor_period")
    # ### end Alembic commands ###
