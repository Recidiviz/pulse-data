# pylint: skip-file
"""new-mo-columns

Revision ID: 481077bd8e34
Revises: 3e56b61df4a9
Create Date: 2019-11-22 18:50:29.427413

"""
from alembic import op
import sqlalchemy as sa
from sqlalchemy.dialects import postgresql


# revision identifiers, used by Alembic.
revision = "481077bd8e34"
down_revision = "3e56b61df4a9"
branch_labels = None
depends_on = None


def upgrade() -> None:
    # ### commands auto generated by Alembic - please adjust! ###
    op.create_table(
        "state_supervision_violated_condition_entry",
        sa.Column("state_code", sa.String(length=255), nullable=False),
        sa.Column("condition", sa.String(length=255), nullable=False),
        sa.Column(
            "supervision_violated_condition_entry_id", sa.Integer(), nullable=False
        ),
        sa.Column("supervision_violation_id", sa.Integer(), nullable=True),
        sa.Column("person_id", sa.Integer(), nullable=False),
        sa.ForeignKeyConstraint(
            ["person_id"],
            ["state_person.person_id"],
            initially="DEFERRED",
            deferrable=True,
        ),
        sa.ForeignKeyConstraint(
            ["supervision_violation_id"],
            ["state_supervision_violation.supervision_violation_id"],
        ),
        sa.PrimaryKeyConstraint("supervision_violated_condition_entry_id"),
    )
    op.create_index(
        op.f("ix_state_supervision_violated_condition_entry_state_code"),
        "state_supervision_violated_condition_entry",
        ["state_code"],
        unique=False,
    )
    op.create_table(
        "state_supervision_violation_type_entry",
        sa.Column("state_code", sa.String(length=255), nullable=False),
        sa.Column(
            "violation_type",
            postgresql.ENUM(
                "ABSCONDED",
                "ESCAPED",
                "FELONY",
                "MISDEMEANOR",
                "MUNICIPAL",
                "TECHNICAL",
                name="state_supervision_violation_type",
                create_type=False,
            ),
            nullable=True,
        ),
        sa.Column("violation_type_raw_text", sa.String(length=255), nullable=True),
        sa.Column("supervision_violation_type_entry_id", sa.Integer(), nullable=False),
        sa.Column("supervision_violation_id", sa.Integer(), nullable=True),
        sa.Column("person_id", sa.Integer(), nullable=False),
        sa.ForeignKeyConstraint(
            ["person_id"],
            ["state_person.person_id"],
            initially="DEFERRED",
            deferrable=True,
        ),
        sa.ForeignKeyConstraint(
            ["supervision_violation_id"],
            ["state_supervision_violation.supervision_violation_id"],
        ),
        sa.PrimaryKeyConstraint("supervision_violation_type_entry_id"),
    )
    op.create_index(
        op.f("ix_state_supervision_violation_type_entry_state_code"),
        "state_supervision_violation_type_entry",
        ["state_code"],
        unique=False,
    )
    op.create_table(
        "state_supervision_violated_condition_entry_history",
        sa.Column("valid_from", sa.DateTime(), nullable=False),
        sa.Column("valid_to", sa.DateTime(), nullable=True),
        sa.Column("state_code", sa.String(length=255), nullable=False),
        sa.Column("condition", sa.String(length=255), nullable=False),
        sa.Column(
            "supervision_violated_condition_entry_history_id",
            sa.Integer(),
            nullable=False,
        ),
        sa.Column(
            "supervision_violated_condition_entry_id", sa.Integer(), nullable=False
        ),
        sa.Column("supervision_violation_id", sa.Integer(), nullable=True),
        sa.Column("person_id", sa.Integer(), nullable=False),
        sa.ForeignKeyConstraint(
            ["person_id"],
            ["state_person.person_id"],
            initially="DEFERRED",
            deferrable=True,
        ),
        sa.ForeignKeyConstraint(
            ["supervision_violated_condition_entry_id"],
            [
                "state_supervision_violated_condition_entry.supervision_violated_condition_entry_id"
            ],
        ),
        sa.ForeignKeyConstraint(
            ["supervision_violation_id"],
            ["state_supervision_violation.supervision_violation_id"],
        ),
        sa.PrimaryKeyConstraint("supervision_violated_condition_entry_history_id"),
    )
    op.create_index(
        op.f(
            "ix_state_supervision_violated_condition_entry_history_supervision_violated_condition_entry_id"
        ),
        "state_supervision_violated_condition_entry_history",
        ["supervision_violated_condition_entry_id"],
        unique=False,
    )
    op.create_index(
        op.f("ix_state_supervision_violated_condition_entry_history_state_code"),
        "state_supervision_violated_condition_entry_history",
        ["state_code"],
        unique=False,
    )
    op.create_table(
        "state_supervision_violation_response_decision_type_entry",
        sa.Column("state_code", sa.String(length=255), nullable=False),
        sa.Column(
            "decision",
            postgresql.ENUM(
                "CONTINUANCE",
                "EXTENSION",
                "REVOCATION",
                "SUSPENSION",
                name="state_supervision_violation_response_decision",
                create_type=False,
            ),
            nullable=True,
        ),
        sa.Column("decision_raw_text", sa.String(length=255), nullable=True),
        sa.Column(
            "revocation_type",
            postgresql.ENUM(
                "REINCARCERATION",
                "RETURN_TO_SUPERVISION",
                "SHOCK_INCARCERATION",
                "TREATMENT_IN_PRISON",
                name="state_supervision_violation_response_revocation_type",
                create_type=False,
            ),
            nullable=True,
        ),
        sa.Column("revocation_type_raw_text", sa.String(length=255), nullable=True),
        sa.Column(
            "supervision_violation_response_decision_type_entry_id",
            sa.Integer(),
            nullable=False,
        ),
        sa.Column("supervision_violation_response_id", sa.Integer(), nullable=True),
        sa.Column("person_id", sa.Integer(), nullable=False),
        sa.ForeignKeyConstraint(
            ["person_id"],
            ["state_person.person_id"],
            initially="DEFERRED",
            deferrable=True,
        ),
        sa.ForeignKeyConstraint(
            ["supervision_violation_response_id"],
            ["state_supervision_violation_response.supervision_violation_response_id"],
        ),
        sa.PrimaryKeyConstraint(
            "supervision_violation_response_decision_type_entry_id"
        ),
    )
    op.create_index(
        op.f("ix_state_supervision_violation_response_decision_type_entry_state_code"),
        "state_supervision_violation_response_decision_type_entry",
        ["state_code"],
        unique=False,
    )
    op.create_table(
        "state_supervision_violation_type_entry_history",
        sa.Column("valid_from", sa.DateTime(), nullable=False),
        sa.Column("valid_to", sa.DateTime(), nullable=True),
        sa.Column("state_code", sa.String(length=255), nullable=False),
        sa.Column(
            "violation_type",
            postgresql.ENUM(
                "ABSCONDED",
                "ESCAPED",
                "FELONY",
                "MISDEMEANOR",
                "MUNICIPAL",
                "TECHNICAL",
                name="state_supervision_violation_type",
                create_type=False,
            ),
            nullable=True,
        ),
        sa.Column("violation_type_raw_text", sa.String(length=255), nullable=True),
        sa.Column(
            "supervision_violation_type_history_id", sa.Integer(), nullable=False
        ),
        sa.Column("supervision_violation_type_entry_id", sa.Integer(), nullable=False),
        sa.Column("supervision_violation_id", sa.Integer(), nullable=True),
        sa.Column("person_id", sa.Integer(), nullable=False),
        sa.ForeignKeyConstraint(
            ["person_id"],
            ["state_person.person_id"],
            initially="DEFERRED",
            deferrable=True,
        ),
        sa.ForeignKeyConstraint(
            ["supervision_violation_id"],
            ["state_supervision_violation.supervision_violation_id"],
        ),
        sa.ForeignKeyConstraint(
            ["supervision_violation_type_entry_id"],
            [
                "state_supervision_violation_type_entry.supervision_violation_type_entry_id"
            ],
        ),
        sa.PrimaryKeyConstraint("supervision_violation_type_history_id"),
    )
    op.create_index(
        op.f("ix_state_supervision_violation_type_entry_history_state_code"),
        "state_supervision_violation_type_entry_history",
        ["state_code"],
        unique=False,
    )
    op.create_index(
        op.f(
            "ix_state_supervision_violation_type_entry_history_supervision_violation_type_entry_id"
        ),
        "state_supervision_violation_type_entry_history",
        ["supervision_violation_type_entry_id"],
        unique=False,
    )
    op.create_table(
        "state_supervision_violation_response_decision_type_entry_history",
        sa.Column("valid_from", sa.DateTime(), nullable=False),
        sa.Column("valid_to", sa.DateTime(), nullable=True),
        sa.Column("state_code", sa.String(length=255), nullable=False),
        sa.Column(
            "decision",
            postgresql.ENUM(
                "CONTINUANCE",
                "EXTENSION",
                "REVOCATION",
                "SUSPENSION",
                name="state_supervision_violation_response_decision",
                create_type=False,
            ),
            nullable=True,
        ),
        sa.Column("decision_raw_text", sa.String(length=255), nullable=True),
        sa.Column(
            "revocation_type",
            postgresql.ENUM(
                "REINCARCERATION",
                "RETURN_TO_SUPERVISION",
                "SHOCK_INCARCERATION",
                "TREATMENT_IN_PRISON",
                name="state_supervision_violation_response_revocation_type",
                create_type=False,
            ),
            nullable=True,
        ),
        sa.Column("revocation_type_raw_text", sa.String(length=255), nullable=True),
        sa.Column(
            "supervision_violation_response_decision_type_entry_history_id",
            sa.Integer(),
            nullable=False,
        ),
        sa.Column(
            "supervision_violation_response_decision_type_entry_id",
            sa.Integer(),
            nullable=False,
        ),
        sa.Column("supervision_violation_response_id", sa.Integer(), nullable=True),
        sa.Column("person_id", sa.Integer(), nullable=False),
        sa.ForeignKeyConstraint(
            ["person_id"],
            ["state_person.person_id"],
            initially="DEFERRED",
            deferrable=True,
        ),
        sa.ForeignKeyConstraint(
            ["supervision_violation_response_decision_type_entry_id"],
            [
                "state_supervision_violation_response_decision_type_entry.supervision_violation_response_decision_type_entry_id"
            ],
        ),
        sa.ForeignKeyConstraint(
            ["supervision_violation_response_id"],
            ["state_supervision_violation_response.supervision_violation_response_id"],
        ),
        sa.PrimaryKeyConstraint(
            "supervision_violation_response_decision_type_entry_history_id"
        ),
    )
    op.create_index(
        op.f(
            "ix_state_supervision_violation_response_decision_type_entry_history_supervision_violation_response_decision_type_entry_id"
        ),
        "state_supervision_violation_response_decision_type_entry_history",
        ["supervision_violation_response_decision_type_entry_id"],
        unique=False,
    )
    op.create_index(
        op.f(
            "ix_state_supervision_violation_response_decision_type_entry_history_state_code"
        ),
        "state_supervision_violation_response_decision_type_entry_history",
        ["state_code"],
        unique=False,
    )
    op.add_column(
        "state_incarceration_sentence",
        sa.Column("is_capital_punishment", sa.Boolean(), nullable=True),
    )
    op.add_column(
        "state_incarceration_sentence_history",
        sa.Column("is_capital_punishment", sa.Boolean(), nullable=True),
    )
    # ### end Alembic commands ###


def downgrade() -> None:
    # ### commands auto generated by Alembic - please adjust! ###
    op.drop_column("state_incarceration_sentence_history", "is_capital_punishment")
    op.drop_column("state_incarceration_sentence", "is_capital_punishment")
    op.drop_index(
        op.f(
            "ix_state_supervision_violation_response_decision_type_entry_history_state_code"
        ),
        table_name="state_supervision_violation_response_decision_type_entry_history",
    )
    op.drop_index(
        op.f(
            "ix_state_supervision_violation_response_decision_type_entry_history_supervision_violation_response_decision_type_entry_id"
        ),
        table_name="state_supervision_violation_response_decision_type_entry_history",
    )
    op.drop_table("state_supervision_violation_response_decision_type_entry_history")
    op.drop_index(
        op.f(
            "ix_state_supervision_violation_type_entry_history_supervision_violation_type_entry_id"
        ),
        table_name="state_supervision_violation_type_entry_history",
    )
    op.drop_index(
        op.f("ix_state_supervision_violation_type_entry_history_state_code"),
        table_name="state_supervision_violation_type_entry_history",
    )
    op.drop_table("state_supervision_violation_type_entry_history")
    op.drop_index(
        op.f("ix_state_supervision_violation_response_decision_type_entry_state_code"),
        table_name="state_supervision_violation_response_decision_type_entry",
    )
    op.drop_table("state_supervision_violation_response_decision_type_entry")
    op.drop_index(
        op.f("ix_state_supervision_violated_condition_entry_history_state_code"),
        table_name="state_supervision_violated_condition_entry_history",
    )
    op.drop_index(
        op.f(
            "ix_state_supervision_violated_condition_entry_history_supervision_violated_condition_entry_id"
        ),
        table_name="state_supervision_violated_condition_entry_history",
    )
    op.drop_table("state_supervision_violated_condition_entry_history")
    op.drop_index(
        op.f("ix_state_supervision_violation_type_entry_state_code"),
        table_name="state_supervision_violation_type_entry",
    )
    op.drop_table("state_supervision_violation_type_entry")
    op.drop_index(
        op.f("ix_state_supervision_violated_condition_entry_state_code"),
        table_name="state_supervision_violated_condition_entry",
    )
    op.drop_table("state_supervision_violated_condition_entry")
    # ### end Alembic commands ###
