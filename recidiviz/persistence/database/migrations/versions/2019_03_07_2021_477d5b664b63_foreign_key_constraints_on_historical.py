"""foreign_key_constraints_on_historical

Revision ID: 477d5b664b63
Revises: 0b32488901d4
Create Date: 2019-03-07 20:21:38.805064

"""

from alembic import op
import sqlalchemy as sa


# revision identifiers, used by Alembic.
revision = '477d5b664b63'
down_revision = '0b32488901d4'
branch_labels = None
depends_on = None


def upgrade():
    # ### commands auto generated by Alembic - please adjust! ###
    op.drop_index('ix_arrest_history_booking_id', table_name='arrest_history')
    op.create_foreign_key(None, 'arrest_history', 'booking', ['booking_id'], ['booking_id'])
    op.create_foreign_key(None, 'bond_history', 'booking', ['booking_id'], ['booking_id'], initially='DEFERRED', deferrable=True)
    op.drop_index('ix_booking_history_person_id', table_name='booking_history')
    op.create_foreign_key(None, 'booking_history', 'person', ['person_id'], ['person_id'])
    op.drop_index('ix_charge_history_bond_id', table_name='charge_history')
    op.drop_index('ix_charge_history_booking_id', table_name='charge_history')
    op.drop_index('ix_charge_history_sentence_id', table_name='charge_history')
    op.create_foreign_key(None, 'charge_history', 'bond', ['bond_id'], ['bond_id'])
    op.create_foreign_key(None, 'charge_history', 'sentence', ['sentence_id'], ['sentence_id'])
    op.create_foreign_key(None, 'charge_history', 'booking', ['booking_id'], ['booking_id'])
    op.drop_index('ix_hold_history_booking_id', table_name='hold_history')
    op.create_foreign_key(None, 'hold_history', 'booking', ['booking_id'], ['booking_id'])
    op.create_foreign_key(None, 'sentence_history', 'booking', ['booking_id'], ['booking_id'], initially='DEFERRED', deferrable=True)
    op.drop_index('ix_sentence_relationship_history_sentence_a_id', table_name='sentence_relationship_history')
    op.drop_index('ix_sentence_relationship_history_sentence_b_id', table_name='sentence_relationship_history')
    op.create_foreign_key(None, 'sentence_relationship_history', 'sentence', ['sentence_b_id'], ['sentence_id'])
    op.create_foreign_key(None, 'sentence_relationship_history', 'sentence', ['sentence_a_id'], ['sentence_id'])
    # ### end Alembic commands ###


def downgrade():
    # ### commands auto generated by Alembic - please adjust! ###
    op.drop_constraint(None, 'sentence_relationship_history', type_='foreignkey')
    op.drop_constraint(None, 'sentence_relationship_history', type_='foreignkey')
    op.create_index('ix_sentence_relationship_history_sentence_b_id', 'sentence_relationship_history', ['sentence_b_id'], unique=False)
    op.create_index('ix_sentence_relationship_history_sentence_a_id', 'sentence_relationship_history', ['sentence_a_id'], unique=False)
    op.drop_constraint(None, 'sentence_history', type_='foreignkey')
    op.drop_constraint(None, 'hold_history', type_='foreignkey')
    op.create_index('ix_hold_history_booking_id', 'hold_history', ['booking_id'], unique=False)
    op.drop_constraint(None, 'charge_history', type_='foreignkey')
    op.drop_constraint(None, 'charge_history', type_='foreignkey')
    op.drop_constraint(None, 'charge_history', type_='foreignkey')
    op.create_index('ix_charge_history_sentence_id', 'charge_history', ['sentence_id'], unique=False)
    op.create_index('ix_charge_history_booking_id', 'charge_history', ['booking_id'], unique=False)
    op.create_index('ix_charge_history_bond_id', 'charge_history', ['bond_id'], unique=False)
    op.drop_constraint(None, 'booking_history', type_='foreignkey')
    op.create_index('ix_booking_history_person_id', 'booking_history', ['person_id'], unique=False)
    op.drop_constraint(None, 'bond_history', type_='foreignkey')
    op.drop_constraint(None, 'arrest_history', type_='foreignkey')
    op.create_index('ix_arrest_history_booking_id', 'arrest_history', ['booking_id'], unique=False)
    # ### end Alembic commands ###
